/* 
 * A runnable main program that tests the functionality of class CurvePoint.
 * 
 * Bitcoin cryptography library
 * Copyright (c) Project Nayuki
 * 
 * http://www.nayuki.io/page/bitcoin-cryptography-library
 * https://github.com/nayuki/Bitcoin-Cryptography-Library
 */

#undef NDEBUG
#include <cstdio>
#include "CurvePoint.hpp"
#include "FieldInt.hpp"
#include "TestHelper.hpp"
#include "Uint256.hpp"


struct TwoStrings {
	const char *a;
	const char *b;
};

struct ThreeStrings {
	const char *a;
	const char *b;
	const char *c;
};

struct FourStrings {
	const char *a;
	const char *b;
	const char *c;
	const char *d;
};

struct SixStrings {
	const char *a;
	const char *b;
	const char *c;
	const char *d;
	const char *e;
	const char *f;
};


static void testReplace() {
	CurvePoint p(CurvePoint::G);
	CurvePoint q(CurvePoint::G);
	q.twice();
	assert(p != q);
	p.replace(q, 0);
	assert(p != q);
	p.replace(q, 1);
	assert(p == q);
}


static int numTestCases = 0;


static void testTwice() {
	// Double zero
	{
		CurvePoint p(CurvePoint::ZERO);
		p.twice();
		assert(p == CurvePoint::ZERO);
		numTestCases++;
	}
	
	// Repeatedly double the base point
	{
		TwoStrings cases[] = {
			{"c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5", "1ae168fea63dc339a3c58419466ceaeef7f632653266d0e1236431a950cfe52a"},
			{"e493dbf1c10d80f3581e4904930b1404cc6c13900ee0758474fa94abe8c4cd13", "51ed993ea0d455b75642e2098ea51448d967ae33bfbdfe40cfe97bdc47739922"},
			{"2f01e5e15cca351daff3843fb70f3c2f0a1bdd05e5af888a67784ef3e10a2a01", "5c4da8a741539949293d082a132d13b4c2e213d6ba5b7617b5da2cb76cbde904"},
			{"e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a", "f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"},
			{"d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65", "95038d9d0ae3d5c3b3d6dec9e98380651f760cc364ed819605b3ff1f24106ab9"},
			{"bf23c1542d16eab70b1051eaf832823cfc4c6f1dcdbafd81e37918e6f874ef8b", "5cb3866fc33003737ad928a0ba5392e4c522fc54811e2f784dc37efe66831d9f"},
			{"34ff3be4033f7a06696c3d09f7d1671cbcf55cd700535655647077456769a24e", "5d9d11623a236c553f6619d89832098c55df16c3e8f8b6818491067a73cc2f1a"},
			{"8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508", "11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"},
			{"465370b287a79ff3905a857a9cf918d50adbc968d9e159d0926e2c00ef34a24d", "35e531b38368c082a4af8bdafdeec2c1588e09b215d37a10a2f8fb20b33887f4"},
			{"241febb8e23cbd77d664a18f66ad6240aaec6ecdc813b088d5b901b2e285131f", "513378d9ff94f8d3d6c420bd13981df8cd50fd0fbd0cb5afabb3e66f2750026d"},
		};
		CurvePoint p(CurvePoint::G);
		for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
			p.twice();
			p.normalize();
			TwoStrings &tc = cases[i];
			assert(p == CurvePoint(tc.a, tc.b));
			numTestCases++;
		}
	}
	
	// Repeatedly double without normalizing
	{
		CurvePoint p(CurvePoint::G);
		for (int i = 0; i < 10; i++)
			p.twice();
		p.normalize();
		assert(p == CurvePoint("241febb8e23cbd77d664a18f66ad6240aaec6ecdc813b088d5b901b2e285131f","513378d9ff94f8d3d6c420bd13981df8cd50fd0fbd0cb5afabb3e66f2750026d"));
		numTestCases++;
	}
	
	// Use random points on the curve
	{
		FourStrings cases[] = {
			{"519c7e9ced6032bca4bd9d3ac556aee94c78394c6d531e614ba892be111d3228", "1d67be39439273c04e45089733ecd781a109ebbef5ee1f09e4f495c8f7c529a0", "a0084a358b4fec688e3360b1420abef644683c9ff4133191828baa7e8185ce63", "6df39473d82e971c128fd67c0df9f75bc49ea71b3f163df357c0ddf8067507b8"},
			{"aa4371e2c7093e0beaf8dd7a898c126716db5574d818d9ba1905f989fed9c571", "db7ee81642570539973ec10ae45c191d0c3090af9161842ad57659ab4a38393d", "04569c88ecb1555f4e92c8820894a00fc2f56eaa2d340b6bfe4648dfb8ada25b", "cc913c5f473bff97cf30ac21e5fa7af227f9738a3cbcfd2afae25ead3b0e20b0"},
			{"ed2c92c9848f3e04a17f9ca6916b343dd512bbabfab178466dc7b8e6f2f7ca6d", "6aa652daf0c26fbaf980ce316d8a318569d688cd6746b485fc9b0ede004ce394", "c08e2b39e5282085b202f7cd11e36a66d601f5b98dd6f797c003b80b5665207c", "ad970b0abad8230b079fe862adbb1f778d88118c844b4769f347ab801640b8d9"},
			{"cedb1da17b8831849418535618435343ce78811cfba7337bae9fb3c369da7639", "bac85ca6f0c510f050ec7dc0c3c8a3d90e3007bd3ce96b3f78621aee3c80f93a", "995e3e760fdf98009d4c63acaa192d59840f5a2f4c156b1956e937bf1d659071", "e1569b822166d8dd04ad80e7bdcefc01d969a61b13a88b2852796a37849d15c9"},
			{"aa68b41e78bf070865cd9ce5a3a05f8b4a192c468b7dd31087fb64efe3a7b3ff", "a844698c828074fda3f2b9d416951c348ab517cb7c097b5f6126e622e06f31f6", "ea9080cc7b7fb4354647e5adf1f47ea1960be93315984dc94b7b846642686a1a", "0953033e7bdd130603c366d21f6e2a75dc440a1df8a4b22ed7a13d4e326c1b8c"},
			{"d526e0eefce73dba5237bc60057b1763937bc03233fcfaa73387b1aa4961f72b", "8db3a0d205898fbf5119cd5b6596295bb59134a0695dd9755c1fe315106ee4c8", "1409bc7a8c63c9c8b33f9b2fa98408625ce0a16b2fd9d6ca0b62655aadb4c27c", "26d238d64b43018860ed17088f9fa2300d31a5fb4fe978e381932e5b395cab46"},
			{"92af8ffe082444bdd0ef3c39425c76d2fd811be457ab78b5ef56aa35d6aa7459", "f135df2307846d4ca38b783a74fe54fe5be2b0dd513c4fb1587ca8c594206cd7", "b2a4a75d51755608e2dc211f3d15e5d476a7c378c3b3c6a1c0d3197eea0d6538", "6394abceb681011a1bb3bd5ace5f6d6e3f5f2baf4304d5a45369993bce8f8823"},
			{"a70aeebac92d7ab9686921f7fb2ec09135a2e688907ce49650edc628fa7b4236", "049aa0bc2249000605fbfdb47d25f9b6d5f407b09de5c5de76edda994331945e", "dcc173f45d003e2f3fdac662cb49ccbc6bd87efa6713d51f84493e5f1d871e5e", "4f179d378e610aadf1457785ef0b72aaf0e9ddb2486dff8c2da83d1ace38eaff"},
			{"0e2f2e1da252ec1424b1cc3ed61b89a29b54e7386c822f1d59108ff1a234cad3", "8dc6f464456eed6908a6d4b96d06bf97e3c249386811b0b4205e501c4de080ab", "f9b4c16d1ca570baf5d8cee33a5d312f0f35a42db2347fc39316ad81343e1e3c", "2c5b66bdfa482f762748c33e41df5dfbae544f5b69f318367277ad8157f7bbb7"},
			{"94cd8d4775b5fa6eb0b042a5041976efb4b09b8aa8c6e58f87b2f8a9d3f79008", "b0aac0e44e27e5326dc2150e89411343aea33109cf9e5272b2a3d15dce16a738", "16bc08cca1c03da886d708b1b5b38ab552e2c83c9dfee67443b273bc57d7120a", "9a5b39a9dbb35f27eca6cab384ffe508d26679742d7bdb13887ed13a04572d20"},
		};
		for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
			FourStrings &tc = cases[i];
			CurvePoint p(tc.a, tc.b);
			p.twice();
			p.normalize();
			assert(p == CurvePoint(tc.c, tc.d));
			numTestCases++;
		}
	}
}


static void testAdd() {
	// Add zero to zero
	{
		CurvePoint p(CurvePoint::ZERO);
		p.add(CurvePoint::ZERO);
		p.normalize();
		assert(p == CurvePoint::ZERO);
		numTestCases++;
	}
	
	// Add zero to point
	{
		TwoStrings cases[] = {
			{"293827d4bf13a446ef11307b4a59bf5f4dc029cf8eddd65bc54e577c6a625970", "7c387ad917234368cf93f16033b8a76abd68cdae2df1994934efdacf6585cd85"},
			{"306024dde1d3137c37890d50ce2732a382dfa0ecc4c3a11f25853c488c806eb8", "0e7958e2a35eb9faa24c87c280e145cd760760b5636b708a3fbcc4c22a9c2f87"},
			{"0c02cc2fc9b01f59863b4069c575c85c19a188c3b484667530863f4caed1ab07", "9986daa568c51553d0b24251337dabc1fe90162a51a34a40242dba6cb25a343e"},
			{"9684e3a232dbc19e2da72f4fad2d421eb6159334abf3d4b0c25fc10910d300b4", "73feb4332777b19887e097d2a4248eb7c1527e8d96beb84df57a643a541d7dd7"},
		};
		for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
			TwoStrings &tc = cases[i];
			CurvePoint p(tc.a, tc.b);
			CurvePoint q(p);
			p.add(CurvePoint::ZERO);
			p.normalize();
			assert(p == q);
			numTestCases++;
		}
	}
	
	// Add point to zero
	{
		TwoStrings cases[] = {
			{"8effba535d10029df26ec3665e19db891317f29981fa73489c60194ac35aa356", "d74944644796aa05281f231ead92783a23aeba166e362d0b435a872c575cf6bf"},
			{"a838e02ce52424511afaf7d32ac14d003efc4ce16cfa7d451dc2d78976384dcd", "630c1613b8c8964c54b3711ef7e71095ef181d0104def6f827776c894168e15b"},
			{"60ee39b1a743e3e4b6eabf2170eb52defb851782c1c6db67d66e764b202825bf", "b75d2f1286dabf517013ffce45b7e7c3906bf19af6fb35e9a53a3642fb44514d"},
			{"250c66a625c171a512d500217f3f46092b1f620e4e1eedf1f2f36794c2f6c40d", "6d8b37be53be61836cfa6ece75b5a6fdd1a4d57ffbd93cd51889aee899971d5c"},
		};
		for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
			TwoStrings &tc = cases[i];
			CurvePoint p(CurvePoint::ZERO);
			CurvePoint q(tc.a, tc.b);
			p.add(q);
			p.normalize();
			assert(p == q);
			numTestCases++;
		}
	}
	
	// Add point to vertical reflection
	{
		ThreeStrings cases[] = {
			{"b8993c93a35f7fe3aeb60239ffa96be23bb789a6f4de7ffd914c2394cc4c3bb3", "f43985da101e21d73481ac98284b7533d8c5e2f37bc5d414d8081e7faf368073", "0bc67a25efe1de28cb7e5367d7b48acc273a1d0c843a2beb27f7e17f50c97bbc"},
			{"700bf4f2a3afa4921f70b2cf207f766d9682a54daf2efa75d8097dac2a494d07", "38fa9b454d542094d7ebd9c3452c70f7a478a93bb9b4ca9a63994437896fd502", "c70564bab2abdf6b2814263cbad38f085b8756c4464b35659c66bbc77690272d"},
			{"7efeb5f0fb582feaf601b334e546cd13cac6b4cc6fa2d0efc0f4c2c56036db54", "0450c1c4025c33fe2f96236498c2f6bc85603871a1128a8a8df6285ab41bc303", "fbaf3e3bfda3cc01d069dc9b673d09437a9fc78e5eed75757209d7a44be4392c"},
			{"96cd45ba6181e7c383e1fa133c8c6f22f8925ae9b2f58d51f103dc1fc2983ae7", "52e36eb7a20b1ba11f30fed7db840b225fe51cfdc404c1018553a2c40ac6332f", "ad1c91485df4e45ee0cf0128247bf4dda01ae3023bfb3efe7aac5d3af539c900"},
		};
		for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
			ThreeStrings &tc = cases[i];
			CurvePoint p(tc.a, tc.b);
			p.add(CurvePoint(tc.a, tc.c));
			p.normalize();
			assert(p == CurvePoint::ZERO);
			numTestCases++;
		}
	}
	
	// Repeatedly add base point to itself (doubling)
	{
		TwoStrings cases[] = {
			{"c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5", "1ae168fea63dc339a3c58419466ceaeef7f632653266d0e1236431a950cfe52a"},
			{"e493dbf1c10d80f3581e4904930b1404cc6c13900ee0758474fa94abe8c4cd13", "51ed993ea0d455b75642e2098ea51448d967ae33bfbdfe40cfe97bdc47739922"},
			{"2f01e5e15cca351daff3843fb70f3c2f0a1bdd05e5af888a67784ef3e10a2a01", "5c4da8a741539949293d082a132d13b4c2e213d6ba5b7617b5da2cb76cbde904"},
			{"e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a", "f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"},
			{"d30199d74fb5a22d47b6e054e2f378cedacffcb89904a61d75d0dbd407143e65", "95038d9d0ae3d5c3b3d6dec9e98380651f760cc364ed819605b3ff1f24106ab9"},
		};
		CurvePoint p(CurvePoint::G);
		for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
			p.add(p);
			p.normalize();
			TwoStrings &tc = cases[i];
			assert(p == CurvePoint(tc.a, tc.b));
			numTestCases++;
		}
	}
	
	// Repeatedly add base point
	{
		TwoStrings cases[] = {
			{"c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5", "1ae168fea63dc339a3c58419466ceaeef7f632653266d0e1236431a950cfe52a"},
			{"f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9", "388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"},
			{"e493dbf1c10d80f3581e4904930b1404cc6c13900ee0758474fa94abe8c4cd13", "51ed993ea0d455b75642e2098ea51448d967ae33bfbdfe40cfe97bdc47739922"},
			{"2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4", "d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"},
			{"fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556", "ae12777aacfbb620f3be96017f45c560de80f0f6518fe4a03c870c36b075f297"},
			{"5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc", "6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"},
			{"2f01e5e15cca351daff3843fb70f3c2f0a1bdd05e5af888a67784ef3e10a2a01", "5c4da8a741539949293d082a132d13b4c2e213d6ba5b7617b5da2cb76cbde904"},
			{"acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe", "cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"},
			{"a0434d9e47f3c86235477c7b1ae6ae5d3442d49b1943c2b752a68e2a47e247c7", "893aba425419bc27a3b6c7e693a24c696f794c2ed877a1593cbee53b037368d7"},
			{"774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb", "d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"},
		};
		CurvePoint p(CurvePoint::G);
		for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
			p.add(CurvePoint::G);
			p.normalize();
			TwoStrings &tc = cases[i];
			assert(p == CurvePoint(tc.a, tc.b));
			numTestCases++;
		}
	}
	
	// Add two random points on curve
	{
		SixStrings cases[] = {
			{"d8e2f51f86ccb79f9774d7f56eeb6d65e012076726eedea4c9bedfc25c780af1", "8546cf18d7f20800376cb6d6c6a3042f39e4da8738ee9a81949deef77fe8cdfe", "f01dc6bb112fb5ffe8e77d173453db479a368794b12b4ac616154b454b7a99cc", "c6a200d4b689220345c67d2f8fd3c9a4789a7a0139efa829e783285e7b7099c7", "0da4159113da119c4d351fe5fa148433251b7868c80c68114fbd1addc660831f", "ea70b1a7fb90118f7491f47ae86596a5763d1be2e58a122e75f137f677b97c8b"},
			{"4f49d384bdbab681da3612e6f31a460445ec2cffeeddff2e1d6abe0bdb483702", "a6154dad136b01339e899f014d93e009e07acfbf258024b3b8c6135627984143", "7a47cf13069a4e516a73e8fc0362b77088e842542b4f5cbdaac77db39508561c", "47e98eadbf4be548f9db09b2e4a36de92049ffd5735651d5cdb794fb22a1a2a5", "0a10b520547be0572a326fe3d375069bcc47b84f80bc5f6155b41c42dd059e93", "6e448864523a61fdf536576c799c2db0f1782f7c1acd9d89e854e778d370a3a7"},
			{"3d2602f0f70649cd7e03254326f24decc79a7040a948ad5a21d97f3ae82a2af9", "15528860fda6a013614a58b7a80791aa6903cac1c0bfff13c0bfe6d80040b7dc", "fc6192342b488f5c1cc356f5b16e68c8c843375dfeb6f1d5e60586a223958ab6", "5a9c457e4aa9b0622401b7b6d1aa8a78d100557e37f01839be4b008292fd19b8", "43fa9a65c8de9f4b5e0ccc959c8cf1cbf59d58287ab34f84d79fcacfbf5ae138", "ea5df38d09be2155d88cd7a10fec168d3281bebbf1b6fac1fb6a6e0ff7c61ece"},
			{"8cd590e2fa6e47ba831510a742e31c5967282cc5af705bb7ee05ddb1ae0a70cc", "3cc503de45487e796b4e87b7e7805450a2411d2162390f8bb2f37f7a8bc0a43f", "2650633f2c463ae2c423a8370d37c89f9415de52ed6e701c8208f0032d74be9d", "41d7e50961a0c46258ef2ebc62165686f68773ab8f0c430504a50c65535f6b0a", "e683b66a22e2fa01b4b9bd2fcc1136a2634a65a9f29803c8f86fb9e953169f0b", "f7ac842df72fe9e7872db5671797a1856f9dc161ee6c26f016b1d1ed3ddfe877"},
			{"d4f1595af9fcd0200007504053d531ebfaafa9ad8b824cd41fd3cbf3a6f89ccf", "7543303d5ad16221371deca33f883dba7e70382a5ebf2b22f5bfc64548f67e09", "19def82a4cac5a0d1c6a1328a3bf31abc4c4739c700033b89a6964cb57ed72dc", "1e98a224f7a980bfb0eb601ed34bd549d8f6e9b5c9893cc0142621f48fd12301", "7994c996e639207e9b2bac683aeed5f6554da0d4573df0c018201da32f43658d", "e5bd7828f71a1471f16139d1955dfc2877c829ce2c2b4da88f88cebcad32489d"},
			{"b4171048a82b057ecbb2410cb5cca894fefd753cb3dbf08f5ae7d1da53b32460", "a612c60587a7471941a690d294ef44e5009cdb2c88609da8e7a3f20851e061a4", "4e84c012316583837a181eed9f4b6b2c93180d59b8401ab9f000c1e794b63b56", "0a2248dd75a023b25710eb8d6f2202d2a8afddcb5a1d3167f24f32f989def523", "658cc032552673790961d1aa665bc5e6904e9c34b2bd188081f29ef01fa088b2", "2da31fe2272c8c35e1a7a8c89630d4690b0d2bc852b4b99fedbab0144575dc7b"},
			{"6bf99f31f70956a43ff30a3dfe7015a1bdea1c72d360bb0c2cbe9009e8eb8df8", "f40a505797bd58f6474b5aa95c1660f9d471196ceebb29944920325a71ee9ef7", "c2674e87cf2f148fa4cd5a5d7301c2f928d9324987b63150a6a23010c51179cd", "a35b2ab12251d0306f28e5a6bd68bbca88681cf318746579a64a8532830f4283", "56a652e288a1243e0f110a5d5b1e27ad47b4a2a2cc0e00ba9f07385b9ae2d26b", "45db788a74cb0a8f4ec82458b8008c0a3395d36851bacd07a2e346fed23d1455"},
			{"ec0cebc10e8a40a62a79d6d71c188efaefe627db850d8fc39ca98311ee9681e1", "b8a6d325f045e42750506bc316860df05270a0034a6a3df329aac51abd267e6b", "f05137fe20f64e3c0b134928a2697f1e7e530a4529cd6ddb4fa897bdb20cffc4", "070e580de65d8f984db6e7cc08cfba4b0a2684b0f1c30cb89b22aee8db81d4f4", "42b4614b78e06a98af4f459c74e75debb462123ffd3c623060a10a245765597b", "e6c6c5bcf997a5717a01031aede414987625475cec47e9e171f0c959e0a5d123"},
			{"a14224fc7c828f17f47cf41e993904837f146f4ceb3a580fc2d1c904c11c230b", "39088e64f90572c0a95ec6fe2169c95189e177a4e51e6a97156832177033dd28", "7de79e3064bac0e0c51d9cb0be4e29d7d92e901506292caabe373d7ca1602e1b", "2ac948dd8724036d0d7b3d3a61bcfde20afe50277f3f14bd03475617770b8ea9", "835937c7310e89ce70937d7e2df2567fa15b12525cccd13f266d2a5031b09111", "ba7fba3c8751c14f9a0e650cfaca9176bc1a592671aa1ce9547d3007632a1455"},
			{"c152768b4ed3f7e3f0d680838c172402185556ab704ff0b0aa862addad05824e", "cd5f61613c622615f1679d4ae82de6cd886e51989fcbcbc769913f24c3d5252a", "d896c04205cac67544c5176e8f257464ee19364a641442f0921a9e3c883237a5", "1bc74789d084c7c100c74466d9ff0dd5b195c57fb0a172ecdf9cae26168a7d1e", "ad6c4498e4e18a48a905910601472e975ec00cbc89dd8714f27bd730533653ce", "1009ad5abd73bcd7cc5c814ca9d2aee18e90fd4127c8ec30c7217f6e794a7932"},
		};
		for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
			SixStrings &tc = cases[i];
			CurvePoint p(tc.a, tc.b);
			p.add(CurvePoint(tc.c, tc.d));
			p.normalize();
			assert(p == CurvePoint(tc.e, tc.f));
			numTestCases++;
		}
	}
}


static void testMultiply() {
	ThreeStrings cases[] = {
		// Small multiples
		{"0000000000000000000000000000000000000000000000000000000000000000", nullptr, nullptr},
		{"0000000000000000000000000000000000000000000000000000000000000001", "79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798", "483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"},
		{"0000000000000000000000000000000000000000000000000000000000000002", "c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5", "1ae168fea63dc339a3c58419466ceaeef7f632653266d0e1236431a950cfe52a"},
		{"0000000000000000000000000000000000000000000000000000000000000003", "f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9", "388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"},
		{"0000000000000000000000000000000000000000000000000000000000000004", "e493dbf1c10d80f3581e4904930b1404cc6c13900ee0758474fa94abe8c4cd13", "51ed993ea0d455b75642e2098ea51448d967ae33bfbdfe40cfe97bdc47739922"},
		{"0000000000000000000000000000000000000000000000000000000000000005", "2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4", "d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"},
		{"0000000000000000000000000000000000000000000000000000000000000006", "fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556", "ae12777aacfbb620f3be96017f45c560de80f0f6518fe4a03c870c36b075f297"},
		{"0000000000000000000000000000000000000000000000000000000000000007", "5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc", "6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"},
		{"0000000000000000000000000000000000000000000000000000000000000008", "2f01e5e15cca351daff3843fb70f3c2f0a1bdd05e5af888a67784ef3e10a2a01", "5c4da8a741539949293d082a132d13b4c2e213d6ba5b7617b5da2cb76cbde904"},
		{"0000000000000000000000000000000000000000000000000000000000000009", "acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe", "cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"},
		{"000000000000000000000000000000000000000000000000000000000000000a", "a0434d9e47f3c86235477c7b1ae6ae5d3442d49b1943c2b752a68e2a47e247c7", "893aba425419bc27a3b6c7e693a24c696f794c2ed877a1593cbee53b037368d7"},
		{"000000000000000000000000000000000000000000000000000000000000000b", "774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb", "d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"},
		{"000000000000000000000000000000000000000000000000000000000000000c", "d01115d548e7561b15c38f004d734633687cf4419620095bc5b0f47070afe85a", "a9f34ffdc815e0d7a8b64537e17bd81579238c5dd9a86d526b051b13f4062327"},
		{"000000000000000000000000000000000000000000000000000000000000000d", "f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8", "0ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"},
		{"000000000000000000000000000000000000000000000000000000000000000e", "499fdf9e895e719cfd64e67f07d38e3226aa7b63678949e6e49b241a60e823e4", "cac2f6c4b54e855190f044e4a7b3d464464279c27a3f95bcc65f40d403a13f5b"},
		{"000000000000000000000000000000000000000000000000000000000000000f", "d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e", "581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"},
		{"0000000000000000000000000000000000000000000000000000000000000010", "e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a", "f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"},
		// Large multiples
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364139", "2f01e5e15cca351daff3843fb70f3c2f0a1bdd05e5af888a67784ef3e10a2a01", "a3b25758beac66b6d6c2f7d5ecd2ec4b3d1dec2945a489e84a25d3479342132b"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413a", "5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc", "951435bf45daa69f5ce8729279e5ab2457ec2f47ec02184a5af7d9d6f78d9755"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413b", "fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556", "51ed8885530449df0c4169fe80ba3a9f217f0f09ae701b5fc378f3c84f8a0998"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413c", "2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4", "2753ddd9c91a1c292b24562259363bd90877d8e454f297bf235782c459539959"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413d", "e493dbf1c10d80f3581e4904930b1404cc6c13900ee0758474fa94abe8c4cd13", "ae1266c15f2baa48a9bd1df6715aebb7269851cc404201bf30168422b88c630d"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e", "f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9", "c77084f09cd217ebf01cc819d5c80ca99aff5666cb3ddce4934602897b4715bd"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413f", "c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5", "e51e970159c23cc65c3a7be6b99315110809cd9acd992f1edc9bce55af301705"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140", "79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798", "b7c52588d95c3b9aa25b0403f1eef75702e84bb7597aabe663b82f6f04ef2777"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141", nullptr, nullptr},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364142", "79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798", "483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364143", "c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5", "1ae168fea63dc339a3c58419466ceaeef7f632653266d0e1236431a950cfe52a"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364144", "f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9", "388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364145", "e493dbf1c10d80f3581e4904930b1404cc6c13900ee0758474fa94abe8c4cd13", "51ed993ea0d455b75642e2098ea51448d967ae33bfbdfe40cfe97bdc47739922"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364146", "2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4", "d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364147", "fff97bd5755eeea420453a14355235d382f6472f8568a18b2f057a1460297556", "ae12777aacfbb620f3be96017f45c560de80f0f6518fe4a03c870c36b075f297"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364148", "5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc", "6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364149", "2f01e5e15cca351daff3843fb70f3c2f0a1bdd05e5af888a67784ef3e10a2a01", "5c4da8a741539949293d082a132d13b4c2e213d6ba5b7617b5da2cb76cbde904"},
		{"fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8", "d8975566d098bc58d56ac778eb2445a8bbbbfea11a70e0aed7258d899e1c0613", "94e691957255ff0c5f2d79bbcdeaea3c25df63c268a10af2e43e7b90e57e9252"},
		{"fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff9", "0527cf8a882b7a8335cc794152791aac0a2e3580f2375c4eabfa99861c8a90c1", "ae4c367f859c2fe818492912a3237e0c33a5aba4e30874287281c44c5c9f032a"},
		{"fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa", "1ff4ddb68af6aeb749b8107b38d76108c0c4562f8efe6087e04575305516caa5", "991a7cca5073b7f44bcc834d6dfe90eb155ee54d774122e3b9387cd26b7a7156"},
		{"fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffb", "64f6309019333daf98303b4630efcc46def0c895d16f830d140c833947f00e1b", "50e58e52650ed0dc8bb1d178a4b14187b4fd9edc98a29327b5f2a7b4e6108115"},
		{"fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc", "2cb62ea7395b82df182570f2adc7326c7cc7fe8d1db31a2071c5e831e3b0df74", "a0fade1641324fc1e4de38568ce5124d9e161a82fdbc40f2df4aade4d58dcf56"},
		{"fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffd", "3fbeac6ef73d496e597dab76c75848e2633cfe3a8492b360d7a21b223afce95d", "1a9128bff344ca910e8334027de4308b3acabcfe6b9799c7a0bfde45a6facf67"},
		{"fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe", "e0a65740c1c5148111a8305938c56322fbf345a18cb90cf48a788961c6b3ff91", "8aaf0580fd9e8be571e97bef4a067fa7911da0ff0e1a5f307fea63e3ecd903af"},
		{"ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff", "9166c289b9f905e55f9e3df9f69d7f356b4a22095f894f4715714aa4b56606af", "f181eb966be4acb5cff9e16b66d809be94e214f06c93fd091099af98499255e7"},
		// Random multiples
		{"45528a55356f7c32ca753f1e58627bc33863670a1072d9c8dd0663eb5691d87f", "86f12a5bda1db7f296b4f1545e417d2dabb28c1e7c96475b97d5aeb9fcad71a5", "2fe6419626eb949db7a6439c6d54a78d42aa596ed74f117e51a6e1cd7af78c1a"},
		{"11d6dd13d560e703c7f0189140df2f692b603ef57a5e10e29c3e163acd1e8ff8", "e222674c42d1b962e51f11c4138a6a75e5ed73d16921c7d381dca0692b2c172e", "90747484c1616b024139138492c716092e41f4a631015196022330b3c5bff7cb"},
		{"e1e1dd6fba9d293b4f5f46be5a3f05a7bce9cdbd8993bc0282dcf6b975d285f1", "75608fb5896949f01c5ab5c655c55b91e56aa40deb0b66dea9bffac718a8be42", "5c75d5ca6abc9f8171e6bbb4ef9b1be632a2fb25bab0e345548505ecc1f3a45e"},
		{"3cbd5de8e80196f3f5db4d925a29638e4bfe4a9a848a9424bad5c46136837c1f", "a964798ae92f981676341bed95e95646fd357de2929666fa967f605f3fb1c739", "06bcbb55bf3c38660c778029a64ceca44bd7af9ae346164fa7ba5a99a292a899"},
		{"efa4125849134857fbc1a97675a43b5de6c1d268e2ca7ab1e179db25f13de00c", "4e3e7a7387c7d8ab2f90df43191f2cf56fb4f09bf1b1ed66501e4e231e4d65a6", "855323dd2b0bded7e96e641a97b5e4d1bcc97ea2a4453bec003208c18896e9c1"},
		{"b177e15f7cf844c240a7749f332df50a692a372d6affd786629686540c8e73f2", "79b63c33938948a2bebf8670ed0a21af7395584d644b0c7f2667a9672030b199", "089ffb15f84a98be1bb2fabd4cfc9fc2b748ec158974d1b5a9aa5191ecb7e7d4"},
		{"9806e0e601fde9777cfba9be56fe90453023e6b08f5be6cb18555156de3ab5c3", "2f413ca9cb2a6e15120b1fcb4f57e907ad3d54e5034a7d7d7efadf59ef5bf50f", "f83c779a884e36d307e6b588b53f62a6407d6f8815708d831ae8102ee26940f3"},
		{"b26c14ecabf65120bc8786a981edad985e8c1d42b146d7f66a8759919b02ae11", "d5e97efbb234e24b4cd39d59062e925a355901ee4d89899c638b4cd9b16cf829", "af21fc31e958c61dc1c6dda55e99444bf04e55940fa71b891540aa4ac94da3bf"},
		{"f56a9e89525ff39cfe2d18bada4e050d0875bf2a2c97237bac9b0f31d191e250", "95cece9600b90d3352e868a5b497f9d134c05a882cb1308fe583061dd6c59f24", "fc8b7a4555770ff9e05a96a3828141ae69b9b89a8e06dea1d5b6da42c95513b8"},
		{"6c2ce63745f8d521bf120f360fbcdc56c8411e177ab6637389e18d289257d435", "222d89ad4cb409ad7ada41ab280d8d2bcc723de7b8521cafa03ad8c839d6cbd1", "c26957d3094f04b394a45e3dbcd11b631bd4f473d293d85e7e92457ab2f23737"},
		{"9ce2b3d4ecbb3ce8cbfebc365d5b0ee3d1dcde114f0a7944cf357a770d27a5e5", "0f92952b176bb2b66b7251016b6ef3a10979a7dd20e3de017498f339b7d47740", "ce2e23afddb77590d6f2b6da13ad70fa212b89a885ff44545cf7eade9dbd1627"},
		{"8e237b486de3bb3156bb7f1493f31e5709449113779b2e70c061ba6ec748de5b", "62d8f6d03a41eb698d845b27e1cfd862a6d4e178b55db4979ac0b01a84599e5c", "8b1926377d460e2a77f0687741dcf5e7b720a24e8189fe2d1706055fa0727b49"},
		{"ba83b8bb8081b74de6b7a2f24d9aa80beb36a8f3670f62715846c4b66b6bf55d", "8a841f13c93473387b2d6db8f43c82ec80a561dff790d0c02f54ac6e8babe596", "981b5ea656254e84efdb72552164deae0e6c452ed2a462763dda1dfb7431775c"},
		{"1bebe58f680ef4f9b05904ad0a06b28da2796f5fcad0ef7a6156dc5b981c89ea", "04f307974e735568bf7ed84d6d9e47c8cbf78362347216103d599233606e02ea", "ef06a534b729ab791c13f93567dad39bc6a85ebac3e607ad1045c4a2ec45abae"},
		{"fa4bb94494e7dd1fd59ea728946e17434eaa6d5e0b9bae191581c55e6a04addf", "a705fdbbd5f8c8f64bed6f13d667357ed200ef4738faaa9d253a3687c0f3e194", "14a40ddd8053bef96529e8a6e4d96579af294fec43986ad483302250a91cb52e"},
		{"f30c65dfe796f9f5e72ffbf00a5693f69bfa56d4a9aba2f12a7f19000e7d2884", "1b24b78e17d1ccc8be2b901dbf3c9f36c3d0be35a30e29b9425c17d06579c3ae", "5ee17b92e7c33f4b4376316ad409cfa729872f06aa70cacb3214b054fc17005c"},
		{"df3a3dc1913ceb70718fa0a07118454b8d5ce9894e0aef5e40df7eb55e32d9df", "da4316fb9d85bf0485e0ce6380b99210f8bea0caf641684f98ef586bdd1295e5", "07860148aabdb47c310dedae95116e40858c1a0e2dd296d821618b3d822ed9ee"},
		{"771057bba5b9c168f34204651c9bd9948ca7f819b717f213c020176bc47c01fe", "8bc8442e4b445df8ae1a723104047b5b599a495a006521041d49819d9bbc4dc3", "cd655aac8d8e1c69ffe8142d12b6445da7ce239f115c63db3caa688c68143c99"},
		{"815a1ef6bb5458ad1567571aacf0b7da2fb5d4307cb52059b1211f3a40469e0e", "c7eb10c596cd9ad02970170b8ca424c310a123589468e615ab1ccb08c0889f67", "26c39ad0442d3b294345eaeda3316dc8bbe5fcb91677068ca6bf4e78d07cf2e6"},
		{"866924a28917a33fe144db60b4d7a27f1dc8b0d26d63372f76e629642245a76b", "6058612c8520cb807e753132e14d497bfd9ec74b172356e5ddc78da1d2aa97a8", "4ebf15d5285a619c6987d47079af89e544c7987795c427939bc5728663295fc4"},
		{"fae4afecd392e1f88eeb28b8ff0c25569530b8dc7141b8061397aed9a49cf9f2", "f46e371ab5fd98a0ed4b15c92cfadecb0787319326a7e561ddd8a6c6080f8642", "1d2b15146f7a7171a1a2d66fb55f50ad970122e7f87f3754a6016d0a52818de0"},
		{"3bfd4640f65ae89e5e46b027d969abcf046af5bde20f8e923787de6473811965", "4bf1e32c1b69d7e0b95726eb8dcf293fb9afb5f4cba7c00f95e2ccd4ee0fd14d", "725352959be783b2e64055f76ff1eace840fa43fa8f72df4db0889ff3e997ddc"},
		{"3dd6e832384e4c1283debf1cd9af94484a6a4458d7fa88fcb853317e923bfee1", "488cecbfed358ede1ce51fcb9f2b34c23f7feb67a800063ab8212871e1941d13", "fbe324ab8fa3c3a3b6d71281fe4555ac80689ea29453f43445d8b74257039f13"},
		{"ca0ccb9483483bd0601220b8a1e5a2f93acad18c794c9eb14c8ab7d8a4001e2e", "8013d6bc2f12a279617c93de87fe85aee7a9f82bd01274301da32126a3d5e8ac", "bed9ed257d0cc0b956f192bcc1f00190a7d0293c222648eb600d28fb3f22cf66"},
		{"9c6236188056ac2cb99cc60fd38ced951590e004282480883bc88b74a1eab3a7", "8333198b3b42e44586a25f0cf5371133220703b44c9b7612fd83abbbba4f78d8", "4c633a0ca354671cf632ed36f749c66bf9d979414ed52dcf04270a0a60224c7a"},
		{"f563bba48829799d3d60e66ac9c0537d1dbdd32a1c2d893153a8384feb0062d8", "2ee54fbb45b4b7a0bf8c5ba332b898d7aedccce1b3e4cda56872ff77fb1f7a2c", "7d5b84b9c5164df9979c5dbfd6fc31d112939f196a9a437329a36742d5e51611"},
		{"406dc83d14de5d2d272c480c42f5988ad6154adcdba66f1d03e7aa36693ff7d3", "d706b8d7ed2e83fc7aa5284de94edbdcaf9fa0d2e1f1c56341f1fbcc570b5612", "0efd57aa3345e14f4f7f290c0fc924fa51fa2a069c8ec961999a2819c0eccafc"},
		{"b9199737b6e6c3126bb68d37e938ecce04f6ecbeeda1e9cbf10aa6138b5c842f", "7943a0c63e51d571184b2469bb371f4d5a2a66bb32e7bb44eb4974882bad8b76", "9387384d13291f8df67ec5ec862f1f5372503771811d5daa4efe190d75dd1a39"},
		{"4263b3e7a22922c05ffce2e922ceebc583b7e5c537c8a4f3572da96bba8813cb", "f1335e670e5cb076ba973c92b24c87bda85b962416539b2111a4317b4be9ae44", "106c70ee074a552ff61d885616003a1139d86a2845464f59c742677464da2110"},
		{"f750484a92e6ed351c6d5cc9738085f62c5389c11e7c6bdfa292efaf20d0ac1c", "3ca82e74725ed3a9d359ae58d094d2e5c327b3f7b1671452c3517842538ff204", "9eba56838328ad2fd2091050c8db174b7952b28ccf9e322e2a006958da3fb625"},
		{"6e139e20daf5e0f98d0f21b7648016579809019f9022da7334edd864e7916b3d", "46f45c0139653c58f80377522f5e43e53e16045a88053ac84a00fd5ea6bfee7d", "743ba29a19e2f118037977b8a614d8dc2427d538c7198632aed237d48e6fe9dd"},
		{"1b4b9e14eab0f76f57b01e1155548ff0ca5ab75c7b28b0ead962662d875c6b74", "a173d134375b449eed2d28b941ff935ec3fcf66255bd6fb10cfd52c219e48812", "133b122da45cc3ddc3e2b5c02e9d86f0aaf4fbe564ef5fcba59ce87858569eaf"},
		{"098ff774af194bedf730a2e3e42d6ba9dcada504b1610133296cfa4def20ce53", "3ba9c946d318b32252b212337e7deaf1127fce02210cd2e4487c28ce8e04307b", "4c5d9a560e8666ac90bcf88fd39a0beb4d302d9b7ad0d5683a2f8d32acd7c988"},
		{"02b36516f5976cf6c3cbd5d5663db4e1c93dd67383ee79627be8a1f2a93ed0ac", "fd01fa210db77f9126f7559b5e0af8927d4a4c45ae5233baf025e5596aa13c58", "b95c7d1519cd85e075ae293a0272a7aaf2cb97f29b64a351a2c512cff7df6b49"},
		{"204ff2cc9f835a21b2fa49d7b3b712b6acb2e3a98e1ef0326f7965dde8e1133e", "9edd38343d35b22c057d37199fbbc530b96e630ba7b4c9a7c5268cc38d626787", "2ccdaaeae19f3a0a5fa1b2c3c03984dfad390262dde254832a1bfb5e4860dbe7"},
		{"c1d10168789cb7eaedb80be73491b572e8866f9c6a8be13a219611d203e96db4", "aed9d3d5b9dc1830a567a837f4acc1a04eb5530ba7035a72c013f54e292834a4", "b967438fcef87d8be5eebbdb336f7606e852e7229dc22db14ba2b17fd7c9553b"},
		{"c279603b48cefc3bdfaaf80f5548b11612c4bcb0746b19915977bb9b21c5f718", "acd33dfb09d55be1a21729408df603253b55087555e4012d677756a02278906b", "660650032dbcaba6cac73027ff78277287a7fbcc6cb4b4a769f4fdd6ec5f5c11"},
		{"7bcba36d1148c7a5ac938ca14c19a947e69f230577c182e243eea7539e5c544b", "7b5d4b743d6fa328dbe32d49c276b123c04887aeaec01f117582e846f6f2255a", "35c32c24b0499a3968cbd609a32eb3627ea99a5798bf50be8b28608bdbe5facb"},
		{"59b5e4509b28e1ea788c777c73337e4dc4f465c8772dad204c8ee5fafe2d4645", "51471c106ee9bc9e4d46acf6409fa3c13787835080b2fe921bb2ccf9699636a9", "8272b678eb7e805a0725bc709e2bb2aea7f10f3a53dae3512d6dc8eebf1d137b"},
	};
	for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
		ThreeStrings &tc = cases[i];
		CurvePoint p(CurvePoint::G);
		p.multiply(Uint256(tc.a));
		p.normalize();
		if (tc.b == nullptr && tc.c == nullptr)
			assert(p == CurvePoint::ZERO);
		else
			assert(p == CurvePoint(tc.b, tc.c));
		numTestCases++;
	}
}


static void testMultiplyModOrder() {
	ThreeStrings cases[] = {
		{"00000000000000000000000000000000000000054c9dc1717d84540608a237d9", "0000158d3f4383cb7cac54e74928b4bfdf58224f42a01a4c6318b0a3bb2bbd4b", "231f5fc63a0601a4931488454123d6461c58d63a0632c5705005b631a8fbc8a4"},
		{"00000000000000000000000000000000000000305e992f03907f26b287500db3", "000000000000195bc7202afeb9ca33432e3e338de729525cd336ea7d4a7b4db5", "86035a47723e45d64472bf5785cfa256a6619271d0b3d3c3be741fc4b0b84ad7"},
		{"000000000000000000000000000000000000003a6032550a5d6324553e1b6f12", "0000000000000000000000000153212c248bf7d55e31087a3aa913546b645697", "4d54f31df7c870dca7cbb5643db2e9841e2edd8ad2e684d507119330c2868f9e"},
		{"00000000000000000000000000000000000006b04bf966c3987ba141fd68c8a0", "00000000000000000000000001cd1fedc181822a2dcbf8361c6ef8bb2b99a0ce", "0c4e5f95e31359063413213a10862d0770739338e6f4b747c30f2d146cca61b4"},
		{"000000000000000000000000000000000001c3640908994650f6d28b3dfaa264", "0000000000000000010104886aa2c7aca649b976c442aa4cb24ded88312df3ed", "3fac44c0f58c2ea3d69eb77041356381503098168c3fa6cb559e3c9ad9ce2a63"},
		{"00000000000000000000000000000000000324c8e1bac6e3a45882124257ae67", "0000000000000000000000000000401bbd0120c2e48fe73946f913fa294c6131", "c9896bca5ad974a301a035f01aba482b9edae2bb186df19ca006832e317168b7"},
		{"000000000000000000000000000000000004ff3468b8c2727f1b989cdd24dfc7", "000000286b60cb514ef7e9ddd026adba6d066a7c9b281432abc226948b0f6b83", "5d68bb266807cb927462d144b70ebbdb5d772fd235b1487b996fbe31b3addd3e"},
		{"0000000000000000000000000000000000071ef7b5acd4fedb970e884a39261e", "000000000000000000000000000000530646098f12ee8bf4807fe13c7c29171c", "024f36fc711851731185e05aa0cf08b32b6e0ef8dd2dbd047762b438e37add48"},
		{"0000000000000000000000000000000000081375508bbab588591f5cb1734d66", "000000000000000000000000000000002716480ede527453f069ecd2acefeebb", "00013baad14b47ff0a6a957f6e32f38a832d4320d042b2303dcabe009b685d82"},
		{"0000000000000000000000000000000000093f3bbe8b96205cd277189a1ca58c", "00000000000000000000000000000000000007a359d8675cfc557a14f3bb734b", "0000000046a1240cff6fa694a1b3da3c29d91f287c2e521d8f085c70d6066404"},
		{"00000000000000000000000000000000000b913abc721053c522deaf59edd912", "00000000000000000000332412baf8c3cbb4731d7df3824a3008b296f2afcfba", "1cc1a6b05afeffb9030df5fddedf78e25b68e2fe1c757910893d0ce5061b391e"},
		{"000000000000000000000000000000000017f80086b7998f0f69127c3355ae7a", "000000000000000000000001268a1e5c20e9234aca25617e85f640ad48359db9", "22afbe2118052d25873986866a9b0ce6c48d8ac7c8ded8aa9a134d26b25fe5ab"},
		{"000000000000000000000000000000000174c12b61d8a82d35a53a3f6bfb9e94", "00000000000000000000000000000000001ee0a9c5cd31f35a8430e18840c358", "00002cf5c34ef612add4685ba72eec64094dc283b9e5839e6f9520480d493ee0"},
		{"00000000000000000000000000000000067545c860a9b9b5b2d50598c83ae0bb", "0000000000000000006a62ad5e3537c65b526d7e057577a003a9c8336d132597", "6a0039a8cced4d86840bc5cac95a49c5c9e3505645a0cbd774a47d2078e98a4d"},
		{"00000000000000000000000000000000b842e2e864157cef8a5370455d4ac6d1", "00000008f245a84cff0342dc1bd7dfae1909f25e51eabb211c349807b2e96ebe", "d6cf6d1fa062ccf0768be03d4df216134af2399d5accf10d135d3c079a7cbea0"},
		{"000000000000000000000000000000017f9235b60f284e6fc389f694fa385e99", "0000000000000000000001ffd13d83845d2c1ed68559ac13daf2e2f136250774", "d4b02a359db1dd32fce933cecb55f1c6dcb4e2c398d61430510e93deeb65ddae"},
		{"00000000000000000000000000000004895028ef3a2af3af82f8f7f1a1754a7c", "00000000000000000000000006cf999b8481bdc02de736489821a355e8d4ee26", "19e6b05500bfe91b1695c0bff2feb4ca6c70f61241009555b3b0747e84bc758f"},
		{"000000000000000000000000000000375cdcff01f61ea2f8e108d1ef19aee89f", "000000001c24f3255f17d0ba0996d5c1726e12d6e2d921edd5334af4b6d38959", "6744b7d3c9f85f78f4a227d879103a1f4ef3f83a3634e751c3ee3c0aac9d97d1"},
		{"00000000000000000000000000000047eb6388c2999ea61c6e01f31a22260a0e", "00000000000000d6062c69e6c0397f0265a3349ae3cc9faa2e6fbb1891f1cde1", "6fa5cbd67569d8568cff6a2e163382f03a06cdd7499ccc0daad8619a8c86b39b"},
		{"000000000000000000000000000001acb971ccb56cf2b865b60e5b5bc9812817", "000000000000000000000000000f6e5251a0572c9579fc1181c7192d87f4bfab", "fe3dcfbb382731b381e5b61a4bb1941e6416446cfb6f45270e1fc58758c10ee8"},
		{"000000000000000000000000000006ca54e90d3827ea670e69d18b034119c4e2", "0000000000000001cdaed94c9dadc6e1f05d56cff12f9f1a6ab01745c4b6072b", "f530ad2660dba512e9840f69cbbbdbdbe67b97dc3f55ac3435ff19bdbcc6d794"},
		{"00000000000000000000000000000d8528fa8bd09da634ee13b37d8edb142668", "0000000000000000000000672f106e7c374eca623f7ea3d943e252862b3c6f05", "be5a99b8fbe89a12e1d9fb90fe3627bfeeda5df20e0b2a6cf29bd488a3c3a43e"},
		{"00000000000000000000000000007ccd4701d24f10fc1ade727310a7b0d883cc", "0000000000000008bfc99a69dd3327ead650d1d53bb1064de16e1f5185e08744", "99209f9e30bf196fd668eb4871dfdc2334cec425431b213784427bf2308638c0"},
		{"000000000000000000000000000135a4abdb0ab6c8903d1512c8cdb8bc37b803", "00000000000185f85f215ef6397dfe076f9b4ce41cda55d80daee47d1301d692", "e998e6383ced4d946a789e6a53488e0540a2e9d90c29d746148067f117b6d65c"},
		{"00000000000000000000000000013b32312519c8195f6cf5e317c062d185c155", "0000000019ed7f9c7f40a01b7ead61afec321ffb39c83b238f2b297ea4b1abb7", "037bee84685e8a9839490caa7030c76daf9cdff85574c5a97c3919d177796b5c"},
		{"00000000000000000000000000017379c46d327959f966dbeeaab778c7eb7aa0", "0000000548f499fe4e81f1459cac8dce325f9f5063b6a189cb988a2f498649e4", "106093aade816610078ef0078e21a0268ed453c7cd656bb7b5a48929c15a1ce7"},
		{"00000000000000000000000000071e6bac01866a5fde9c0d2cc2ebe286d42564", "00000000000000000000000000000000001fd134a46b01af184a4dee4ea1b1b0", "80567bf2331c84c614af9292f034083d0f92f2cc96ffba0ee94f986d8bb23d5e"},
		{"000000000000000000000000000fdbe31a9e96bb03938ae179fdfef01bdd8fed", "00000339be5c78ae92d092ef62e06f34720f5273c26dca7bb8f32a1172e13e94", "8c32a55227b39fead4fe13df78d5ad7926fa2f4087f77aec2787cd4a54fca753"},
		{"000000000000000000000000002de6cfcbc1d4f3786f95bd17f2763039d35f58", "0000000000000000000000328376858ca07e6f8fb1e5af38d0cdf6ac812b8dbf", "e0c02a64b2071f11e49e078f7c4f4eee59237480f563956f9b2349afe07615de"},
		{"00000000000000000000000000c62494c857d13446f3b370a6b03ac9bfd07596", "00000000156fd3391a93120734eeeca1548aa7c0c295627ec8ea5af513bb8ea5", "67fc4f95adce0f7d5a1a86455b5dd3934e72fe40d6f0bcaa285cfeed28ec1e6d"},
		{"00000000000000000000000001846f2d77bf2627e58bea27c02a8a1b03274288", "00000000000000000000000000000000000004fac2e2a4428aaf0eb8da80c8a2", "8e38fc69c456ac32726331abd25a7a851299811be11a7ee0db142dbe0d569149"},
		{"00000000000000000000000006a2748dcb0a61d1db7637df2d048150af59ff95", "0000000000000000000000000000aa103d0e087ac8b2a8fbb8800c09684de257", "0101930a9d08bdb639a0249f170a2328a64910dc1577e38000b96c7482cfaa91"},
		{"0000000000000000000000000807c30eb8a6bb13f6f1cc251f8487f856430dcb", "000000000000000006e0c6092eb97dacc3cd4f8eb602230c2c37920aa3ac4c4b", "bb6f1c3de9280a8a9523006637106a6da2371875454cd4219a25d5787c14acf9"},
		{"00000000000000000000000023aae00dedb3cd0f5a92ddceafb7063add4b1918", "0000000000002c471bff33b1ab0b99821858ec7394998e8b9ea6d786d7c1cdf9", "001548699036095d7061fc19a8a2095e73b97e7d61f2641fec6ace1ddb3df7b3"},
		{"000000000000000000000000670873173a6a208185f448eaef61b87fe3134d58", "0000000000000000000000000000000000000007073e147ddc58e8f84e1749af", "d4255d136becfe9d022be1a0a17b621e24f36d294d03c9233b7ccf9fddbb74a6"},
		{"0000000000000000000000027ac4d06396aed01898f1eb173d037e6e97cac3c6", "00000000000c2c7d1b5169306be4267b989aeca85409e9e3fce19aa5a3f85cd9", "5414a1cd93217fa34005f23f822e5ae55a8a4fa47bdd8c1212728458f2a42456"},
		{"000000000000000000000007781a865648c6e59229d84cd1b2ec579b2736248b", "000000000000000000024df37ecc6db2220cc8d9c9fd9889ac06fdabaaf0bd8b", "ba04222907e35536928e784e10064e561071e797ea02e6e8177a812413324578"},
		{"0000000000000000000000115c394478a07d11a056704088aa02eb9000fa12f1", "0000039369aaad3d7bd8c1c01adac5f7b6c4513def667f9d02356aaeffc7a1a7", "bc887b5c5510ae93b9a9ab386ea291d639388ce352200608e7f759d9e2ac40e5"},
		{"00000000000000000000001ab58fac7be1cbb3d998d8a7bda436244c8a9bb39f", "00000000000000000000000000000222af8acbebb30a2c0fd609ad034378ef7e", "854445b0840b16edb28fa57c0876cba385ab7d90166d99d6f6c89792ab5e705f"},
		{"00000000000000000000001b0f8c4730e341b529f4f907c890e2d3655711ea56", "0000000000008bf5339ef21853dd173880bad81d76b6acb4f629eae3ebbe241c", "692af26b6056bbced5f525876a8ce1353ae08d0a85a984a2b51c987b7aaf9136"},
		{"00000000000000000000002bbfcc3e401faefd962a591b3d4b51abddad7a6a5d", "000000000000000000000000000000000001167bc97424bfef5b586a8db76e14", "602c1869883317b1013bfa82a4df49b9f9473f16be141b24dbb6d7a125cca315"},
		{"0000000000000000000000565fe78e4ade3aaaebfe2180835c0363c91b0376e4", "6d4ea3b13b760b5952d40ac540a6ef791b203702b2a99aac0ccb247454cfa520", "29463fb13ea2684dbb6322fee5f64410a032cc724416a17cd53008a6d4b4f32e"},
		{"0000000000000000000003860b3eb21f6104b172e0630cec40f3d00fb996f997", "000000000000000000000000002c45f1d9bc859a3248a6cbb572b9cf5f3e1290", "05b8644bcc1b08a76a341bffb0c1f13a515b81e9d176d0f8d2c4367aeb5be8be"},
		{"0000000000000000000004870048bf1b9ede6b18409d1595c191995bbdd9c4d5", "000000000000000000000c4fa590141b4b16d0f02325b32cb43cf1d14802c978", "51b60ddc96275fd460aef22ef6ca875459bdc34c2324fc632ec54f2d993bb9f7"},
		{"000000000000000000000aea531880d942b7ecbf2f6ed52849c910d7e4a2d43d", "00000000000113aefc659d29d1c3902eab46ecc46a0d8580d943424c6d20c8f2", "8dc88c23f2147b92deda2cf12c77ef84cc515379d05629c077159693170ce2c3"},
		{"000000000000000000000b2cc9c03804857b6cc5ed85881a545488e23388bd27", "0000000000005faf365838bb2a24534c4f4b2d452de63223f52e75a32a45e62f", "65d188bcf7d7c70fb034984fa73f453dff81b19f0665876c7cbcfce88d37f402"},
		{"00000000000000000000b5b1dc197cef644b622e6be576dedd3c55b09f186a23", "0001b9ea5761caa4779aaa5c23e33959069feca0cae406e7e4f345999d8f4f95", "403fc56e1749e67418c68047c50587cae50ad9f06eb7c05d6bd17dc280d2e292"},
		{"00000000000000000000d132929caa0271021b0443273dac0737f1bc6d79f8c6", "00000000000000000000000000000000cce7e292d089087d8c0dd73bb266dea1", "57d0b0487ff9b092665b00992067b47395bb9d8ddf027a9e918b1f8337dfff80"},
		{"00000000000000000017f9d96fcd58fc073b44924372cc0bbc44e7709077c30f", "0000000000000000000000000000000003a3bd318c1905191f484c5e22d3b59f", "672a3147b6edfee3a5c6cbf19ca328601d3e20d3c2d9b1ef61c98924c88906e3"},
		{"0000000000000000001b385c99a473e01a73611caf68313b3bbf8088605f5a2b", "000000000000000000000000000000000000001b9da443a1d85513afb4d2e7e7", "4ada301a10f4df7def131a1d83eb4154ddc3f0fd0661825d125bce42b4e07601"},
		{"000000000000000001689371eabccfd2c14f38f71c3a02f15bbdb80a86888ea5", "0000006971e70fb6a37b6a0c9c8104eb5d50a5baa6f56f1451bb2551b85adca4", "a371f3d35e9976b3d1608a7e20bc05dace7628116fd5d8c998546be91f663e77"},
		{"0000000000000000074d65b3d91284226ca6151f357ecb17a06683f10f1a7e4c", "0000000000000000039977749e784a0d2b164ae52a63e960ffe524dc43caaf6a", "3d31ba32a40c07e63f99de6c8c67875967d1739a386fa00e6332bbb0906c3953"},
		{"000000000000000012ce561f7476091acfe261b29a202bd7af9f332b00bd7639", "00000000000000000000944c435c67e84a82e9632c20c2aa543416db8b2d4503", "93f24d66eb4c4aa6059667e2ca7c9d3fd86d5efcaaa37cd417083060078ce88d"},
		{"000000000000000018473507f79ae6f9a3d2765742a8bfa790cec6dc59eebbf8", "00000000000000000000000000001ecc21414022dee19a925045b0617eaa805f", "e03f30946ef4ea47230a1ff1059941cc5f2e7fea5475472a656c9b3b8caae59c"},
		{"0000000000000000350ddbfe935cec33708a9ffa72a207283cccdc75dcdb4d6d", "006894037d247140e4ac7f6f74362bce08e518f0fa5aaee5cb78d89e3a120926", "d6880aa19c609d3178d1c97d88fdecb8b3a1b7f8743ab05e8756cc5b28a92761"},
		{"000000000000000065790d6ed8a9284c7ca5da112decdeaeb9ff7004bfbb1233", "00000000000000000000000000000003a02a1bc883c6e0cf371f44586d5e51fe", "26e399e7155ab899cce059a63022f8e38cf021c556a308bc23f49b341ce25f75"},
		{"0000000000000000c1fa5040c304caa9054ffa2e3759518cb524560c77e778c6", "000000000000000000000000000b9580787a79eda59d8c5ddc372d7a3a961a82", "8af31479fb6c446cff7b260ea178b2e93df72b754632d01c410cf81da80f6480"},
		{"0000000000000001ed88070829447cdd08e07a45e6382f54ef0eef72a566b240", "000000000000000000000000531c3ceb1c50ee2d29e7d52bf308016e018b4f61", "7a60856eae610a58eeee4d6d0c77a7c67f8066c3b97f7947d78c4a955a8856a1"},
		{"0000000000000002121fc67592c4538b67ef0f668b1adf74e3d970c19bad0b01", "00000000000000047c83b8a7d5adcb3b74e561bafba5efc40e15e40f16ad1cfe", "68eff3e9b9b91030d190c40437e859d60c651516e14866b501005696c26d38c4"},
		{"0000000000000002a41b114b97db38330327af95c4a5a13c77edba422b5f2629", "00226e3ae7a9ee8d571ec3d3c05a5b3b37c8ba1ac2ce36bdc4b6c7b30f673cda", "0a952b28ac856249513ae0e1f311856f05443878c0f751da81b30488a828e6f1"},
		{"000000000000000353398fbbc1f1aaf4ad551fb7495f478c8c04006aadc63550", "00000000000000035e35f68d8ad9648d2130ca460d8c9abcd58dc8a672e78810", "a4bd65a65b321fd66c511b4c152b914f60a921968dfe750ab0396a85c42ee19a"},
		{"0000000000000003916e39364847380f8b51ff0ba1a66aca083a5433fc34caa4", "000000000000000000000000000000004685e9757c617651c735ab8fa145f8ea", "cc5dc2509b3e939c5f739d512a71f99a59c8ab947ddbc6a0c9d6b1f357362ad6"},
		{"000000000000000592c84f0b63ed0766e3058887b9c23facd341a16bad3a9378", "000000000000000000063ff4b090e55d67534be58902d28a233a52b349e0af12", "6cda19b4159780d5c0b4dbe545a872231aeb1291277d9cea4b8cc1962673024e"},
		{"0000000000000007685e08a72ef279df40cec113e366223fa250ba06244d5916", "000000000000000000000014033aee1c2d445050482f492dd478a5949a16df58", "06a2021783605ffc37f507edaeb29825a9e5bca6c158fa5c8d2fcf42639e1eb4"},
		{"000000000000000c0f38eaaf4d2d56ae93d94342ac139e9219272e7d0914db34", "00000000000000000000000000000005f3c6b26e5aa3bd93b19caf6ea44da897", "83f6ae8c060e49ca1456a5609a1cacd45e7e9bdd22f2cb33a9a191ba7b0d083d"},
		{"000000000000000e182ca78886424b3ce491f34679efc83711cb88f3c7c795f4", "00000000000000000000000000000000b58b95c791bd80bfefd968dcff6789d3", "70741b6a584fcb85e251fd2fce9dbe47c3f08a6ed3d3db0e80404a18bc6403e3"},
		{"0000000000000076fcfeb7b651fddaff14687bd6258b8bb3d4ec1ac95116d980", "00000000000000000000000000000000051c80b4bc52f61adcca5e62e8a67efc", "55c8bc953668a3fdc3886448dd525229b4c89525c8205039b95e23fe7600316b"},
		{"00000000000000e298c209355396b380273ac2b9282040a342424d6842921b6a", "00000000000000000796794d0260d2951b54665fdc78eeb6e29385055845ccb0", "dbba952aeb093459e11d1e74c548102f7f660fe5e2957accc5bb637179470835"},
		{"000000000000014f1cb8bc5a1ca6495b048000f3c23d39121bf9590f6501f232", "00000006fa434f57ae00e5c6bea17c85b724c170b9dd21bfe7f40480289a786e", "ad58e040c8f17294010e0296abd6af3ac9744f63fc300a8148fbddf963adf1bc"},
		{"000000000000040af301cdd792ec55937f604d95ecbc524a92855653a72b1183", "00000000000005e68b3f2fd45f5564bc162cdeeca738b3b1f2b564dd4df357b9", "e06fe69aefb34dda1cf3d387bd993089b3a74fe361531e7d7495dfd77b84aae7"},
		{"0000000000000ca1989f1e4dd06f120b6692305996c634b7ac64a3d867fd84c2", "000000000bc0b1cb1d04d4fa6c23236336ef5f87a7cd96f19f693808f9ce81b9", "d2e15dfa99dfa87f3853c07e7f42814791c946fd3a912e372048028f3875cdb7"},
		{"0000000000000e1bb7b1034b9185a8641faf264096aa708da82f0889572363d0", "05be2c6c5c454fe78f59330b3ebd77801f10f344f61385deae34fe6cdf6d2668", "c6b2a173a2b385a99d1002811df16f3255a08ff30a3003ae145d016ceb1d1e22"},
		{"00000000000018eba298c2368d5c1bc99e415c26286a53c18cc5997b7e44f145", "0000000000000000000000000001d753ad91c3b3caa9c474fcfc2f629446f90f", "f188f243b057282e37d846b0d4a2ff4b3dd4252e04ea8fee71579e370a875d04"},
		{"0000000000002bff96a10391986d604780aeb02cf7db8a0953e2e8812dcdfcbc", "000000000000000000000000000000f830ec7e56cbea1a2922f4c4cd097e6bfd", "11f1e2aebd3efa5ee6e933bc916fedbbba89d0c1a639e8eec32ca76ed71f2337"},
		{"0000000000003b65f10994b468166b43546a123f2eef564c9b0005d8ad1c2578", "0982772fd855eb1f707c4054dec2e6196d8b5418836cf0f1eb4b1041ebd69f77", "d1f300c61140409c932250be3b6e4cdb3968caada297ff3fa21156d760d26920"},
		{"000000000000e259f70126128edcdb034b73a2b6f6a0a8b92aea672d1e711ee6", "0000000007e397f3df07af78f0731ab12707cd8907d6d6598840ef3cf341df76", "4a680827fdd9b852d340d63c5535dbac35098dc3b0393925ae876752ccdadea3"},
		{"000000000000eae9224712c1314f8b192dc903e07b032848af9c2142156f7b64", "000000000000e6c158af9da9b5e760ceee373647581f85b94f665393e37e0c03", "4b5c8db1c19c4433e2bd481e0d5d1af3b242baaac0d63465433e7976e2da7959"},
		{"00000000001fef813bb1e9ddf47f1c5a36ea7a44f3e10979d4ae7951451eb4c5", "000000000000000000000000cb63ca115c4568491cc818f55312f6fdc06db22f", "64a0a4517c5e05847423426fe43a8e166c4570214bfe845a1dbdddf748151647"},
		{"00000000002627cf0ffb6c33f1382e55c83914d7ea8968b7e3ed543740fa345b", "0000000000000000000000000000000002dd00447c7815c6ff25dd25ee3d4859", "93ee99f3d207ef41ca19841d6a1c129717d640f92fd4bd86d4ac704f4be93275"},
		{"0000000000b6605e407376b8d010f939e4427890700f46d886aedd94cacbc365", "00000000000000000000007191dbc44b22c59b6b366038ba939691bc8a197812", "4c6c09238db5e593b7a7d0a711535613317915b81b650eea49b0cf088d94be10"},
		{"00000000018a0bbfbdbe8125c22b9460c4a8c88fbc489627554f948988d3531e", "00000000000000000000333f969564fc82a322583eb1c214a9fb434fb7bb6238", "fe87840f5a51463fb8ef553e6d1bb5393b64b79aa8aa021941a9939d7a64cb13"},
		{"0000000002188e491f2e4e2beb176582d4956ceff4f7604b8b905578de122b9b", "00000000000000000000000000001f03a80805957b2e849f8d717c7e35951bed", "4cf2614c1673fb43cb17df013c099b0dcf7ac88f502f0edf42f5bf54e75cc71f"},
		{"000000000810643e4e70dd261901dd93acdd47af0d970253f5239948cf4695bc", "00000000000000000000005ee529d34413e6701eadf9bdde206d5d7192b78ef2", "235075602822dc4b03b200068995ee38e4f02d86a55bfd9281dd5bbcb2dc3dc3"},
		{"0000000ce3dba4f1a6de33df007b74f8348e880a5ebcc0c84ed0f15ef0f4d1b7", "1b8ae2a7a517e4fe5136a01ee05b8651efe9ebc1d57a1ce926e8bde8d33ff2be", "86ae76074388e781fafdfd8cfd442f6f4a2dd505602acccc8c021ec6adc2ed57"},
		{"000000bd89585b09710168d979b7792e687da0886998b67d1d65e274f1f47205", "03287540105e312a1d7a1f5c322499836c40afc06301f6d5be0150ffc0e71ab0", "e885128c0303bdf3307eb42c81d8ae69210a62000cf0bb1ceb8bb983b2bb34d7"},
		{"000002421b603ae6abc44eece49a53ca57ff0705ee34d1cb70ad27ec7ac2617b", "0000000000000000000000000000000000223d2e256cb108682e35878e428d3c", "84e5c478886ba089ce496f3cc3f61187f015eaac94308761a815152f3ba1e159"},
		{"000003915bf1b8de4dc96f356413ea543ab7b97f95e3eef1b7f56d7eec547661", "000000000000000000000000000000000000003936781cedd0a7050ac2a19d58", "a8c76e53fd410cf50af52b9742129306104c3e7464d4edfdf549231410aab130"},
		{"000013947f70cfefea13a8b540fb4f092194bcbe02c6dd07eb25bb3d503a14ee", "0007238ac8432226b11ca4a75b51e9de27cff370b355cba11d4ea6eaf5af78bf", "de42d762c57f1f3faff22167e1a606cd9395d4c9b4e3d9efdd14e65784564a64"},
		{"000077dad0d4c70fe3dc3f3cb421c3b514cd16d0693badddb571bcc099bd9cc6", "00000000000000000000000000000000000000276d0e3bc8504f9ba260198ae2", "e9ca1e9ef86a13f7389507a20b2b2afba0da764e6fe43eb91b06434345947f62"},
		{"0000e266cd2accabd888b3c9b358c3175a74623eb72f49cedc6bff479b853a28", "000000000000005036629926c63b1fb896c0f36575a86357fe273c832139cd7c", "1d335c71d41034aae9b9d882a2737fda38a3ec980b449f74d214c6dcd55eb3a2"},
		{"000198aa2c53620ae8e551d0fa9bef2732df3104457c73930c778707a120833d", "0000000000000001756cad86e47398bd87bef7b9280972a1e41ba2d1f83654a3", "5c50ceb5d7ed89e4f35b7c5ce72b33ccdd8a86a9bc311c5dfca1f005ad47f6fb"},
		{"0002cc80caa6b204b06cbe0b22dfa9c1134c679116e5644e22fc61d0cc55d2e3", "0000000000f9d190e26dcb41d9a04e80c18fc7bfa7012f3e5bb24b42a35629fd", "9bf42f22bb4adddc5afa4b5a70dbc5c3d5690810f45a53a4cfe3ac5da7e7f2e6"},
		{"00055d796cb7eb598cc231fa679c271d018fd853b2d1f0112de4c6f0d37327cd", "000000000000000000000000000047822f1d9ee6ca35d282c39fccc7a0fd1ee6", "e5de2ec2730a9246c8ee07e7cb15d5261eea8c28d3e9d55d864ed006013285e4"},
		{"0020921d3cb837d05b8fdc802070a2b495f7600e388bd34fc311fb50fe2accc5", "0000000000000000000000005e1d5c76c84a311bd65f3af3e65055f0547a13c3", "6e04cd4d2b66b3f98aebadb9ec53e66334775572559b552066e5af7b9a11e759"},
		{"004c35bebada0cf615e6f936368d6249b29e70cc02a984bd544173d30858a346", "0000000002053b5e46899dc8cbd3d21792c65fed2d6a6fc8bf85361ca9dec06b", "4c1207203eb5a2ff3dcf98d1933c94b3c4022202f2e5dec9e1502c60a49dfca9"},
		{"00aa1eb8b1dd9734be83c3585682fb982a7091f33a513920649e04c4f54ec9ab", "00000000000000000000000000000000000f42267d57e7135872110e5ba35eee", "1ceefb362c42ae31de7ebc3a76d92a102d2ebb02b2a66524d98c4e7f0d55a899"},
		{"00ca5f3dfca3a4a3eb5e2ffcbb516c47d95ba1f7c87745085eb80da3de753bea", "0000000000f1e31533849590cad86b324082cb5a77b2a2b944f2df5b88281d1e", "85c700c0820e21808935c1e07adfb6120f71d2dfaa0b95daaec049f135a6ebd5"},
		{"0285577c5736ad97043b6d047b4e9c37e259bb10563515bcb6f44b49e9ae6407", "0bc492dc24da6ac4678a82a123a946fa4e34b3184aac4c1da3fd95ec06231ad7", "871658a6845a2e5c30da9f5a4ffb7dfbcbab7e36c984e9f26e7ec3f9ead24e6b"},
		{"07e846c9227a4cb6ab42c1dd2212271a020ca9a5360b4d2e86532096cc28b0f0", "6141d41f38b684c637757f481ce155fc74a479179891f8add96b39c358ad32b8", "ee7a199abbdd95691ed1fa0544bb323c8ccd0ad88ad5108a2246f820dd4f5140"},
		{"0c7f3663e0c94609b4ed2d85702ab1d8c8522b72763495b29c0f96521c76f42f", "0000000000000000000000000000000000032ce080803b7a13dda23fc7172d7b", "b1d7d0419e6524521747397340df1a10612ecebc7f33e9b609058b0bff2b56ea"},
		{"185f1a31c76c1319b2adc91d4713d0490bcd46e17f01b25f1814cd6ac5acb07b", "820bd103157b9e46c7c7bf3869ff62107f38a769373917101b44eaa206169b14", "0d93320f92e7e37a5a477915438986837b0141d5960d5ce24911cd4fee3b2fdf"},
		{"21fd10b57e729d5cf698457f1bfb33c05461c3286c157b3a0b29d15dae44a72f", "9a1be44e73c555ed8a3b95c829423d2b607b21b72ef62167b18f2a98ee5d57b3", "068ea6f1f44eaba41388d558b34f5ce4bf2e6b8bf8246478626cc8e6aa4bca60"},
		{"23eff8a188e850427398668993ccda6aea75e4460d14b0c2ecdeef7f999b83d0", "000000000000000000000000000000007e11294a6888281486ccb4bcc86c026d", "d8f746af623674e28cc9570ecb07a24175f6ab5c664b0bd441cfc7ae84ebdf8d"},
		{"3ca00b8bacfcea0d84d56bff140e76687f004b35bc4e083ce9c8f5f8aeedcf47", "07ac194e89b5191298e4c250761d2d60ae2a5e6708ddc21ee02a5f4b038eff15", "3f4d24e6287a0e478e36dbd69ffc979354cc7ffe3342697e884c00275a9e8378"},
		{"499c55147795257df2cc8bfd407e24782b5025a7ab894b21742d3b2d9f98d160", "6685b0e744f44153c0f3786a270c3c62434f59b6b6b525f6e6524fa61eb986a5", "242d1b1ebaadf4bcecf2be7165ab268cc6b6270ff8835807b14d28bbe6c2c72a"},
		{"5f1f4bfdedd29f0689892a69507bf8c7d50d47adcc7d9c2615298f30de645137", "fb063f7500d7dd0219b9b9a19fd2196e58d1c9629232a75c9eec38a8095e13d4", "942baebe9a49aef24c13911fe4f213bc8a583c1b012d13060bca1235fa4b3fe8"},
		{"b70cfec366e46390b39bb572d0511b88aa2ae6c5fd68d21368624696947b3869", "48fc042f64bcfe653ca2defb5e03bf91b6cc42093f0bf0e69a49286792c42780", "561aeac7a8f80c950c9a0f864cc2fc4c35dfe546d2dc26bb6e4aa823b7e50652"},
		{"dbd14aa6d37d93a19ed5f09178f1e02984b4c7fcb0235f55b7897cd3f143cac9", "209aa16772271923d258a8ee1ac51e8e684fe89a841ebe9a5f72f07170b2f9ae", "8c149286067e400f21945ae21e0378268048bcadf6e7ddde607f03d73c5659f7"},
		{"e3e7d5bba9e6ba0acf981607fad8004beb31d99121f5aed271c2b31a22753341", "f754c7681141d64e70fd8c2de1723fae23dd9cc64e359210f7ce6e1a68b2fc58", "9e1bc1f3577b9dba7f24e20ce23e3022a4074e0cd50b54f3f2c00e908ea70cb5"},
		{"ee1ac7935818699ad1790fc415776484c6d3d8d90c4d8ebc3686c152b822d076", "9950dfb98e10659f3ea73a635a1b1547b9b54c1e9128a4b418e4be938007f968", "b53e6a97998d2af4b97ae947aeb4f308ecbe08b163c01bbb4cf33ede2e6bf4d8"},
	};
	for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
		ThreeStrings &tc = cases[i];
		Uint256 a(tc.a);
		Uint256 b(tc.b);
		
		CurvePoint p(CurvePoint::G);
		p.multiply(a);
		p.multiply(b);
		p.normalize();
		
		CurvePoint q(CurvePoint::G);
		q.multiply(a);
		q.normalize();
		q.multiply(b);
		q.normalize();
		
		CurvePoint r(CurvePoint::G);
		r.multiply(Uint256(tc.c));
		r.normalize();
		
		assert(p == q && q == r);
		numTestCases++;
	}
}


static void testPrivateExponentToPublicPoint() {
	ThreeStrings cases[] = {
		{"0000000000000000000000000000000000000000000000000000000000000001", "79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798", "483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8"},
		{"0000000000000000000000000000000000000000000000000000000000000002", "c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5", "1ae168fea63dc339a3c58419466ceaeef7f632653266d0e1236431a950cfe52a"},
		{"000000000000000000000000000000000000000000000000000000000000000f", "d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e", "581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"},
		{"0000000000000000000000000000000000000000000000000000000000000010", "e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a", "f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364139", "2f01e5e15cca351daff3843fb70f3c2f0a1bdd05e5af888a67784ef3e10a2a01", "a3b25758beac66b6d6c2f7d5ecd2ec4b3d1dec2945a489e84a25d3479342132b"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413a", "5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc", "951435bf45daa69f5ce8729279e5ab2457ec2f47ec02184a5af7d9d6f78d9755"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413c", "2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4", "2753ddd9c91a1c292b24562259363bd90877d8e454f297bf235782c459539959"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413e", "f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9", "c77084f09cd217ebf01cc819d5c80ca99aff5666cb3ddce4934602897b4715bd"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd036413f", "c6047f9441ed7d6d3045406e95c07cd85c778e4b8cef3ca7abac09b95c709ee5", "e51e970159c23cc65c3a7be6b99315110809cd9acd992f1edc9bce55af301705"},
		{"fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364140", "79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798", "b7c52588d95c3b9aa25b0403f1eef75702e84bb7597aabe663b82f6f04ef2777"},
	};
	for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
		ThreeStrings &tc = cases[i];
		CurvePoint p(CurvePoint::privateExponentToPublicPoint(Uint256(tc.a)));
		assert(p.x == FieldInt(tc.b) && p.y == FieldInt(tc.c) && p.z == FieldInt::ONE);
		numTestCases++;
	}
}


int main(int argc, char **argv) {
	testReplace();
	testTwice();
	testAdd();
	testMultiply();
	testMultiplyModOrder();
	testPrivateExponentToPublicPoint();
	printf("All %d test cases passed\n", numTestCases);
	return 0;
}
