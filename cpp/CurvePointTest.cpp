/* 
 * A runnable main program that tests the functionality of class CurvePoint.
 * 
 * Bitcoin cryptography library
 * Copyright (c) Project Nayuki
 * 
 * http://www.nayuki.io/page/bitcoin-cryptography-library
 * https://github.com/nayuki/Bitcoin-Cryptography-Library
 */

#include "TestHelper.hpp"
#include <cstdio>
#include "CurvePoint.hpp"
#include "FieldInt.hpp"
#include "Uint256.hpp"


/*---- Structures ----*/

struct TwoStrings {
	const char *a;
	const char *b;
};

struct ThreeStrings {
	const char *a;
	const char *b;
	const char *c;
};

struct FourStrings {
	const char *a;
	const char *b;
	const char *c;
	const char *d;
};

struct SixStrings {
	const char *a;
	const char *b;
	const char *c;
	const char *d;
	const char *e;
	const char *f;
};


// Global variables
static int numTestCases = 0;


/*---- Test cases ----*/

static void testReplace() {
	CurvePoint p(CurvePoint::G);
	CurvePoint q(CurvePoint::G);
	q.twice();
	assert(p != q);
	p.replace(q, 0);
	assert(p != q);
	p.replace(q, 1);
	assert(p == q);
	numTestCases++;
}


static void testTwice() {
	// Double zero
	{
		CurvePoint p(CurvePoint::ZERO);
		p.twice();
		assert(p == CurvePoint::ZERO);
		numTestCases++;
	}
	
	// Repeatedly double the base point
	{
		TwoStrings cases[] = {
			{"C6047F9441ED7D6D3045406E95C07CD85C778E4B8CEF3CA7ABAC09B95C709EE5", "1AE168FEA63DC339A3C58419466CEAEEF7F632653266D0E1236431A950CFE52A"},
			{"E493DBF1C10D80F3581E4904930B1404CC6C13900EE0758474FA94ABE8C4CD13", "51ED993EA0D455B75642E2098EA51448D967AE33BFBDFE40CFE97BDC47739922"},
			{"2F01E5E15CCA351DAFF3843FB70F3C2F0A1BDD05E5AF888A67784EF3E10A2A01", "5C4DA8A741539949293D082A132D13B4C2E213D6BA5B7617B5DA2CB76CBDE904"},
			{"E60FCE93B59E9EC53011AABC21C23E97B2A31369B87A5AE9C44EE89E2A6DEC0A", "F7E3507399E595929DB99F34F57937101296891E44D23F0BE1F32CCE69616821"},
			{"D30199D74FB5A22D47B6E054E2F378CEDACFFCB89904A61D75D0DBD407143E65", "95038D9D0AE3D5C3B3D6DEC9E98380651F760CC364ED819605B3FF1F24106AB9"},
			{"BF23C1542D16EAB70B1051EAF832823CFC4C6F1DCDBAFD81E37918E6F874EF8B", "5CB3866FC33003737AD928A0BA5392E4C522FC54811E2F784DC37EFE66831D9F"},
			{"34FF3BE4033F7A06696C3D09F7D1671CBCF55CD700535655647077456769A24E", "5D9D11623A236C553F6619D89832098C55DF16C3E8F8B6818491067A73CC2F1A"},
			{"8282263212C609D9EA2A6E3E172DE238D8C39CABD5AC1CA10646E23FD5F51508", "11F8A8098557DFE45E8256E830B60ACE62D613AC2F7B17BED31B6EAFF6E26CAF"},
			{"465370B287A79FF3905A857A9CF918D50ADBC968D9E159D0926E2C00EF34A24D", "35E531B38368C082A4AF8BDAFDEEC2C1588E09B215D37A10A2F8FB20B33887F4"},
			{"241FEBB8E23CBD77D664A18F66AD6240AAEC6ECDC813B088D5B901B2E285131F", "513378D9FF94F8D3D6C420BD13981DF8CD50FD0FBD0CB5AFABB3E66F2750026D"},
		};
		CurvePoint p(CurvePoint::G);
		for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
			p.twice();
			p.normalize();
			TwoStrings &tc = cases[i];
			assert(p == CurvePoint(tc.a, tc.b));
			numTestCases++;
		}
	}
	
	// Repeatedly double without normalizing
	{
		CurvePoint p(CurvePoint::G);
		for (int i = 0; i < 10; i++)
			p.twice();
		p.normalize();
		assert(p == CurvePoint("241FEBB8E23CBD77D664A18F66AD6240AAEC6ECDC813B088D5B901B2E285131F","513378D9FF94F8D3D6C420BD13981DF8CD50FD0FBD0CB5AFABB3E66F2750026D"));
		numTestCases++;
	}
	
	// Use random points on the curve
	{
		FourStrings cases[] = {
			{"519C7E9CED6032BCA4BD9D3AC556AEE94C78394C6D531E614BA892BE111D3228", "1D67BE39439273C04E45089733ECD781A109EBBEF5EE1F09E4F495C8F7C529A0", "A0084A358B4FEC688E3360B1420ABEF644683C9FF4133191828BAA7E8185CE63", "6DF39473D82E971C128FD67C0DF9F75BC49EA71B3F163DF357C0DDF8067507B8"},
			{"AA4371E2C7093E0BEAF8DD7A898C126716DB5574D818D9BA1905F989FED9C571", "DB7EE81642570539973EC10AE45C191D0C3090AF9161842AD57659AB4A38393D", "04569C88ECB1555F4E92C8820894A00FC2F56EAA2D340B6BFE4648DFB8ADA25B", "CC913C5F473BFF97CF30AC21E5FA7AF227F9738A3CBCFD2AFAE25EAD3B0E20B0"},
			{"ED2C92C9848F3E04A17F9CA6916B343DD512BBABFAB178466DC7B8E6F2F7CA6D", "6AA652DAF0C26FBAF980CE316D8A318569D688CD6746B485FC9B0EDE004CE394", "C08E2B39E5282085B202F7CD11E36A66D601F5B98DD6F797C003B80B5665207C", "AD970B0ABAD8230B079FE862ADBB1F778D88118C844B4769F347AB801640B8D9"},
			{"CEDB1DA17B8831849418535618435343CE78811CFBA7337BAE9FB3C369DA7639", "BAC85CA6F0C510F050EC7DC0C3C8A3D90E3007BD3CE96B3F78621AEE3C80F93A", "995E3E760FDF98009D4C63ACAA192D59840F5A2F4C156B1956E937BF1D659071", "E1569B822166D8DD04AD80E7BDCEFC01D969A61B13A88B2852796A37849D15C9"},
			{"AA68B41E78BF070865CD9CE5A3A05F8B4A192C468B7DD31087FB64EFE3A7B3FF", "A844698C828074FDA3F2B9D416951C348AB517CB7C097B5F6126E622E06F31F6", "EA9080CC7B7FB4354647E5ADF1F47EA1960BE93315984DC94B7B846642686A1A", "0953033E7BDD130603C366D21F6E2A75DC440A1DF8A4B22ED7A13D4E326C1B8C"},
			{"D526E0EEFCE73DBA5237BC60057B1763937BC03233FCFAA73387B1AA4961F72B", "8DB3A0D205898FBF5119CD5B6596295BB59134A0695DD9755C1FE315106EE4C8", "1409BC7A8C63C9C8B33F9B2FA98408625CE0A16B2FD9D6CA0B62655AADB4C27C", "26D238D64B43018860ED17088F9FA2300D31A5FB4FE978E381932E5B395CAB46"},
			{"92AF8FFE082444BDD0EF3C39425C76D2FD811BE457AB78B5EF56AA35D6AA7459", "F135DF2307846D4CA38B783A74FE54FE5BE2B0DD513C4FB1587CA8C594206CD7", "B2A4A75D51755608E2DC211F3D15E5D476A7C378C3B3C6A1C0D3197EEA0D6538", "6394ABCEB681011A1BB3BD5ACE5F6D6E3F5F2BAF4304D5A45369993BCE8F8823"},
			{"A70AEEBAC92D7AB9686921F7FB2EC09135A2E688907CE49650EDC628FA7B4236", "049AA0BC2249000605FBFDB47D25F9B6D5F407B09DE5C5DE76EDDA994331945E", "DCC173F45D003E2F3FDAC662CB49CCBC6BD87EFA6713D51F84493E5F1D871E5E", "4F179D378E610AADF1457785EF0B72AAF0E9DDB2486DFF8C2DA83D1ACE38EAFF"},
			{"0E2F2E1DA252EC1424B1CC3ED61B89A29B54E7386C822F1D59108FF1A234CAD3", "8DC6F464456EED6908A6D4B96D06BF97E3C249386811B0B4205E501C4DE080AB", "F9B4C16D1CA570BAF5D8CEE33A5D312F0F35A42DB2347FC39316AD81343E1E3C", "2C5B66BDFA482F762748C33E41DF5DFBAE544F5B69F318367277AD8157F7BBB7"},
			{"94CD8D4775B5FA6EB0B042A5041976EFB4B09B8AA8C6E58F87B2F8A9D3F79008", "B0AAC0E44E27E5326DC2150E89411343AEA33109CF9E5272B2A3D15DCE16A738", "16BC08CCA1C03DA886D708B1B5B38AB552E2C83C9DFEE67443B273BC57D7120A", "9A5B39A9DBB35F27ECA6CAB384FFE508D26679742D7BDB13887ED13A04572D20"},
		};
		for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
			FourStrings &tc = cases[i];
			CurvePoint p(tc.a, tc.b);
			p.twice();
			p.normalize();
			assert(p == CurvePoint(tc.c, tc.d));
			numTestCases++;
		}
	}
}


static void testAdd() {
	// Add zero to zero
	{
		CurvePoint p(CurvePoint::ZERO);
		p.add(CurvePoint::ZERO);
		p.normalize();
		assert(p == CurvePoint::ZERO);
		numTestCases++;
	}
	
	// Add zero to point
	{
		TwoStrings cases[] = {
			{"293827D4BF13A446EF11307B4A59BF5F4DC029CF8EDDD65BC54E577C6A625970", "7C387AD917234368CF93F16033B8A76ABD68CDAE2DF1994934EFDACF6585CD85"},
			{"306024DDE1D3137C37890D50CE2732A382DFA0ECC4C3A11F25853C488C806EB8", "0E7958E2A35EB9FAA24C87C280E145CD760760B5636B708A3FBCC4C22A9C2F87"},
			{"0C02CC2FC9B01F59863B4069C575C85C19A188C3B484667530863F4CAED1AB07", "9986DAA568C51553D0B24251337DABC1FE90162A51A34A40242DBA6CB25A343E"},
			{"9684E3A232DBC19E2DA72F4FAD2D421EB6159334ABF3D4B0C25FC10910D300B4", "73FEB4332777B19887E097D2A4248EB7C1527E8D96BEB84DF57A643A541D7DD7"},
		};
		for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
			TwoStrings &tc = cases[i];
			CurvePoint p(tc.a, tc.b);
			CurvePoint q(p);
			p.add(CurvePoint::ZERO);
			p.normalize();
			assert(p == q);
			numTestCases++;
		}
	}
	
	// Add point to zero
	{
		TwoStrings cases[] = {
			{"8EFFBA535D10029DF26EC3665E19DB891317F29981FA73489C60194AC35AA356", "D74944644796AA05281F231EAD92783A23AEBA166E362D0B435A872C575CF6BF"},
			{"A838E02CE52424511AFAF7D32AC14D003EFC4CE16CFA7D451DC2D78976384DCD", "630C1613B8C8964C54B3711EF7E71095EF181D0104DEF6F827776C894168E15B"},
			{"60EE39B1A743E3E4B6EABF2170EB52DEFB851782C1C6DB67D66E764B202825BF", "B75D2F1286DABF517013FFCE45B7E7C3906BF19AF6FB35E9A53A3642FB44514D"},
			{"250C66A625C171A512D500217F3F46092B1F620E4E1EEDF1F2F36794C2F6C40D", "6D8B37BE53BE61836CFA6ECE75B5A6FDD1A4D57FFBD93CD51889AEE899971D5C"},
		};
		for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
			TwoStrings &tc = cases[i];
			CurvePoint p(CurvePoint::ZERO);
			CurvePoint q(tc.a, tc.b);
			p.add(q);
			p.normalize();
			assert(p == q);
			numTestCases++;
		}
	}
	
	// Add point to vertical reflection
	{
		ThreeStrings cases[] = {
			{"B8993C93A35F7FE3AEB60239FFA96BE23BB789A6F4DE7FFD914C2394CC4C3BB3", "F43985DA101E21D73481AC98284B7533D8C5E2F37BC5D414D8081E7FAF368073", "0BC67A25EFE1DE28CB7E5367D7B48ACC273A1D0C843A2BEB27F7E17F50C97BBC"},
			{"700BF4F2A3AFA4921F70B2CF207F766D9682A54DAF2EFA75D8097DAC2A494D07", "38FA9B454D542094D7EBD9C3452C70F7A478A93BB9B4CA9A63994437896FD502", "C70564BAB2ABDF6B2814263CBAD38F085B8756C4464B35659C66BBC77690272D"},
			{"7EFEB5F0FB582FEAF601B334E546CD13CAC6B4CC6FA2D0EFC0F4C2C56036DB54", "0450C1C4025C33FE2F96236498C2F6BC85603871A1128A8A8DF6285AB41BC303", "FBAF3E3BFDA3CC01D069DC9B673D09437A9FC78E5EED75757209D7A44BE4392C"},
			{"96CD45BA6181E7C383E1FA133C8C6F22F8925AE9B2F58D51F103DC1FC2983AE7", "52E36EB7A20B1BA11F30FED7DB840B225FE51CFDC404C1018553A2C40AC6332F", "AD1C91485DF4E45EE0CF0128247BF4DDA01AE3023BFB3EFE7AAC5D3AF539C900"},
		};
		for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
			ThreeStrings &tc = cases[i];
			CurvePoint p(tc.a, tc.b);
			p.add(CurvePoint(tc.a, tc.c));
			p.normalize();
			assert(p == CurvePoint::ZERO);
			numTestCases++;
		}
	}
	
	// Repeatedly add base point to itself (doubling)
	{
		TwoStrings cases[] = {
			{"C6047F9441ED7D6D3045406E95C07CD85C778E4B8CEF3CA7ABAC09B95C709EE5", "1AE168FEA63DC339A3C58419466CEAEEF7F632653266D0E1236431A950CFE52A"},
			{"E493DBF1C10D80F3581E4904930B1404CC6C13900EE0758474FA94ABE8C4CD13", "51ED993EA0D455B75642E2098EA51448D967AE33BFBDFE40CFE97BDC47739922"},
			{"2F01E5E15CCA351DAFF3843FB70F3C2F0A1BDD05E5AF888A67784EF3E10A2A01", "5C4DA8A741539949293D082A132D13B4C2E213D6BA5B7617B5DA2CB76CBDE904"},
			{"E60FCE93B59E9EC53011AABC21C23E97B2A31369B87A5AE9C44EE89E2A6DEC0A", "F7E3507399E595929DB99F34F57937101296891E44D23F0BE1F32CCE69616821"},
			{"D30199D74FB5A22D47B6E054E2F378CEDACFFCB89904A61D75D0DBD407143E65", "95038D9D0AE3D5C3B3D6DEC9E98380651F760CC364ED819605B3FF1F24106AB9"},
		};
		CurvePoint p(CurvePoint::G);
		for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
			p.add(p);
			p.normalize();
			TwoStrings &tc = cases[i];
			assert(p == CurvePoint(tc.a, tc.b));
			numTestCases++;
		}
	}
	
	// Repeatedly add base point
	{
		TwoStrings cases[] = {
			{"C6047F9441ED7D6D3045406E95C07CD85C778E4B8CEF3CA7ABAC09B95C709EE5", "1AE168FEA63DC339A3C58419466CEAEEF7F632653266D0E1236431A950CFE52A"},
			{"F9308A019258C31049344F85F89D5229B531C845836F99B08601F113BCE036F9", "388F7B0F632DE8140FE337E62A37F3566500A99934C2231B6CB9FD7584B8E672"},
			{"E493DBF1C10D80F3581E4904930B1404CC6C13900EE0758474FA94ABE8C4CD13", "51ED993EA0D455B75642E2098EA51448D967AE33BFBDFE40CFE97BDC47739922"},
			{"2F8BDE4D1A07209355B4A7250A5C5128E88B84BDDC619AB7CBA8D569B240EFE4", "D8AC222636E5E3D6D4DBA9DDA6C9C426F788271BAB0D6840DCA87D3AA6AC62D6"},
			{"FFF97BD5755EEEA420453A14355235D382F6472F8568A18B2F057A1460297556", "AE12777AACFBB620F3BE96017F45C560DE80F0F6518FE4A03C870C36B075F297"},
			{"5CBDF0646E5DB4EAA398F365F2EA7A0E3D419B7E0330E39CE92BDDEDCAC4F9BC", "6AEBCA40BA255960A3178D6D861A54DBA813D0B813FDE7B5A5082628087264DA"},
			{"2F01E5E15CCA351DAFF3843FB70F3C2F0A1BDD05E5AF888A67784EF3E10A2A01", "5C4DA8A741539949293D082A132D13B4C2E213D6BA5B7617B5DA2CB76CBDE904"},
			{"ACD484E2F0C7F65309AD178A9F559ABDE09796974C57E714C35F110DFC27CCBE", "CC338921B0A7D9FD64380971763B61E9ADD888A4375F8E0F05CC262AC64F9C37"},
			{"A0434D9E47F3C86235477C7B1AE6AE5D3442D49B1943C2B752A68E2A47E247C7", "893ABA425419BC27A3B6C7E693A24C696F794C2ED877A1593CBEE53B037368D7"},
			{"774AE7F858A9411E5EF4246B70C65AAC5649980BE5C17891BBEC17895DA008CB", "D984A032EB6B5E190243DD56D7B7B365372DB1E2DFF9D6A8301D74C9C953C61B"},
		};
		CurvePoint p(CurvePoint::G);
		for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
			p.add(CurvePoint::G);
			p.normalize();
			TwoStrings &tc = cases[i];
			assert(p == CurvePoint(tc.a, tc.b));
			numTestCases++;
		}
	}
	
	// Add two random points on curve
	{
		SixStrings cases[] = {
			{"D8E2F51F86CCB79F9774D7F56EEB6D65E012076726EEDEA4C9BEDFC25C780AF1", "8546CF18D7F20800376CB6D6C6A3042F39E4DA8738EE9A81949DEEF77FE8CDFE", "F01DC6BB112FB5FFE8E77D173453DB479A368794B12B4AC616154B454B7A99CC", "C6A200D4B689220345C67D2F8FD3C9A4789A7A0139EFA829E783285E7B7099C7", "0DA4159113DA119C4D351FE5FA148433251B7868C80C68114FBD1ADDC660831F", "EA70B1A7FB90118F7491F47AE86596A5763D1BE2E58A122E75F137F677B97C8B"},
			{"4F49D384BDBAB681DA3612E6F31A460445EC2CFFEEDDFF2E1D6ABE0BDB483702", "A6154DAD136B01339E899F014D93E009E07ACFBF258024B3B8C6135627984143", "7A47CF13069A4E516A73E8FC0362B77088E842542B4F5CBDAAC77DB39508561C", "47E98EADBF4BE548F9DB09B2E4A36DE92049FFD5735651D5CDB794FB22A1A2A5", "0A10B520547BE0572A326FE3D375069BCC47B84F80BC5F6155B41C42DD059E93", "6E448864523A61FDF536576C799C2DB0F1782F7C1ACD9D89E854E778D370A3A7"},
			{"3D2602F0F70649CD7E03254326F24DECC79A7040A948AD5A21D97F3AE82A2AF9", "15528860FDA6A013614A58B7A80791AA6903CAC1C0BFFF13C0BFE6D80040B7DC", "FC6192342B488F5C1CC356F5B16E68C8C843375DFEB6F1D5E60586A223958AB6", "5A9C457E4AA9B0622401B7B6D1AA8A78D100557E37F01839BE4B008292FD19B8", "43FA9A65C8DE9F4B5E0CCC959C8CF1CBF59D58287AB34F84D79FCACFBF5AE138", "EA5DF38D09BE2155D88CD7A10FEC168D3281BEBBF1B6FAC1FB6A6E0FF7C61ECE"},
			{"8CD590E2FA6E47BA831510A742E31C5967282CC5AF705BB7EE05DDB1AE0A70CC", "3CC503DE45487E796B4E87B7E7805450A2411D2162390F8BB2F37F7A8BC0A43F", "2650633F2C463AE2C423A8370D37C89F9415DE52ED6E701C8208F0032D74BE9D", "41D7E50961A0C46258EF2EBC62165686F68773AB8F0C430504A50C65535F6B0A", "E683B66A22E2FA01B4B9BD2FCC1136A2634A65A9F29803C8F86FB9E953169F0B", "F7AC842DF72FE9E7872DB5671797A1856F9DC161EE6C26F016B1D1ED3DDFE877"},
			{"D4F1595AF9FCD0200007504053D531EBFAAFA9AD8B824CD41FD3CBF3A6F89CCF", "7543303D5AD16221371DECA33F883DBA7E70382A5EBF2B22F5BFC64548F67E09", "19DEF82A4CAC5A0D1C6A1328A3BF31ABC4C4739C700033B89A6964CB57ED72DC", "1E98A224F7A980BFB0EB601ED34BD549D8F6E9B5C9893CC0142621F48FD12301", "7994C996E639207E9B2BAC683AEED5F6554DA0D4573DF0C018201DA32F43658D", "E5BD7828F71A1471F16139D1955DFC2877C829CE2C2B4DA88F88CEBCAD32489D"},
			{"B4171048A82B057ECBB2410CB5CCA894FEFD753CB3DBF08F5AE7D1DA53B32460", "A612C60587A7471941A690D294EF44E5009CDB2C88609DA8E7A3F20851E061A4", "4E84C012316583837A181EED9F4B6B2C93180D59B8401AB9F000C1E794B63B56", "0A2248DD75A023B25710EB8D6F2202D2A8AFDDCB5A1D3167F24F32F989DEF523", "658CC032552673790961D1AA665BC5E6904E9C34B2BD188081F29EF01FA088B2", "2DA31FE2272C8C35E1A7A8C89630D4690B0D2BC852B4B99FEDBAB0144575DC7B"},
			{"6BF99F31F70956A43FF30A3DFE7015A1BDEA1C72D360BB0C2CBE9009E8EB8DF8", "F40A505797BD58F6474B5AA95C1660F9D471196CEEBB29944920325A71EE9EF7", "C2674E87CF2F148FA4CD5A5D7301C2F928D9324987B63150A6A23010C51179CD", "A35B2AB12251D0306F28E5A6BD68BBCA88681CF318746579A64A8532830F4283", "56A652E288A1243E0F110A5D5B1E27AD47B4A2A2CC0E00BA9F07385B9AE2D26B", "45DB788A74CB0A8F4EC82458B8008C0A3395D36851BACD07A2E346FED23D1455"},
			{"EC0CEBC10E8A40A62A79D6D71C188EFAEFE627DB850D8FC39CA98311EE9681E1", "B8A6D325F045E42750506BC316860DF05270A0034A6A3DF329AAC51ABD267E6B", "F05137FE20F64E3C0B134928A2697F1E7E530A4529CD6DDB4FA897BDB20CFFC4", "070E580DE65D8F984DB6E7CC08CFBA4B0A2684B0F1C30CB89B22AEE8DB81D4F4", "42B4614B78E06A98AF4F459C74E75DEBB462123FFD3C623060A10A245765597B", "E6C6C5BCF997A5717A01031AEDE414987625475CEC47E9E171F0C959E0A5D123"},
			{"A14224FC7C828F17F47CF41E993904837F146F4CEB3A580FC2D1C904C11C230B", "39088E64F90572C0A95EC6FE2169C95189E177A4E51E6A97156832177033DD28", "7DE79E3064BAC0E0C51D9CB0BE4E29D7D92E901506292CAABE373D7CA1602E1B", "2AC948DD8724036D0D7B3D3A61BCFDE20AFE50277F3F14BD03475617770B8EA9", "835937C7310E89CE70937D7E2DF2567FA15B12525CCCD13F266D2A5031B09111", "BA7FBA3C8751C14F9A0E650CFACA9176BC1A592671AA1CE9547D3007632A1455"},
			{"C152768B4ED3F7E3F0D680838C172402185556AB704FF0B0AA862ADDAD05824E", "CD5F61613C622615F1679D4AE82DE6CD886E51989FCBCBC769913F24C3D5252A", "D896C04205CAC67544C5176E8F257464EE19364A641442F0921A9E3C883237A5", "1BC74789D084C7C100C74466D9FF0DD5B195C57FB0A172ECDF9CAE26168A7D1E", "AD6C4498E4E18A48A905910601472E975EC00CBC89DD8714F27BD730533653CE", "1009AD5ABD73BCD7CC5C814CA9D2AEE18E90FD4127C8EC30C7217F6E794A7932"},
		};
		for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
			SixStrings &tc = cases[i];
			CurvePoint p(tc.a, tc.b);
			p.add(CurvePoint(tc.c, tc.d));
			p.normalize();
			assert(p == CurvePoint(tc.e, tc.f));
			numTestCases++;
		}
	}
}


static void testMultiply() {
	ThreeStrings cases[] = {
		// Small multiples
		{"0000000000000000000000000000000000000000000000000000000000000000", nullptr, nullptr},
		{"0000000000000000000000000000000000000000000000000000000000000001", "79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798", "483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8"},
		{"0000000000000000000000000000000000000000000000000000000000000002", "C6047F9441ED7D6D3045406E95C07CD85C778E4B8CEF3CA7ABAC09B95C709EE5", "1AE168FEA63DC339A3C58419466CEAEEF7F632653266D0E1236431A950CFE52A"},
		{"0000000000000000000000000000000000000000000000000000000000000003", "F9308A019258C31049344F85F89D5229B531C845836F99B08601F113BCE036F9", "388F7B0F632DE8140FE337E62A37F3566500A99934C2231B6CB9FD7584B8E672"},
		{"0000000000000000000000000000000000000000000000000000000000000004", "E493DBF1C10D80F3581E4904930B1404CC6C13900EE0758474FA94ABE8C4CD13", "51ED993EA0D455B75642E2098EA51448D967AE33BFBDFE40CFE97BDC47739922"},
		{"0000000000000000000000000000000000000000000000000000000000000005", "2F8BDE4D1A07209355B4A7250A5C5128E88B84BDDC619AB7CBA8D569B240EFE4", "D8AC222636E5E3D6D4DBA9DDA6C9C426F788271BAB0D6840DCA87D3AA6AC62D6"},
		{"0000000000000000000000000000000000000000000000000000000000000006", "FFF97BD5755EEEA420453A14355235D382F6472F8568A18B2F057A1460297556", "AE12777AACFBB620F3BE96017F45C560DE80F0F6518FE4A03C870C36B075F297"},
		{"0000000000000000000000000000000000000000000000000000000000000007", "5CBDF0646E5DB4EAA398F365F2EA7A0E3D419B7E0330E39CE92BDDEDCAC4F9BC", "6AEBCA40BA255960A3178D6D861A54DBA813D0B813FDE7B5A5082628087264DA"},
		{"0000000000000000000000000000000000000000000000000000000000000008", "2F01E5E15CCA351DAFF3843FB70F3C2F0A1BDD05E5AF888A67784EF3E10A2A01", "5C4DA8A741539949293D082A132D13B4C2E213D6BA5B7617B5DA2CB76CBDE904"},
		{"0000000000000000000000000000000000000000000000000000000000000009", "ACD484E2F0C7F65309AD178A9F559ABDE09796974C57E714C35F110DFC27CCBE", "CC338921B0A7D9FD64380971763B61E9ADD888A4375F8E0F05CC262AC64F9C37"},
		{"000000000000000000000000000000000000000000000000000000000000000A", "A0434D9E47F3C86235477C7B1AE6AE5D3442D49B1943C2B752A68E2A47E247C7", "893ABA425419BC27A3B6C7E693A24C696F794C2ED877A1593CBEE53B037368D7"},
		{"000000000000000000000000000000000000000000000000000000000000000B", "774AE7F858A9411E5EF4246B70C65AAC5649980BE5C17891BBEC17895DA008CB", "D984A032EB6B5E190243DD56D7B7B365372DB1E2DFF9D6A8301D74C9C953C61B"},
		{"000000000000000000000000000000000000000000000000000000000000000C", "D01115D548E7561B15C38F004D734633687CF4419620095BC5B0F47070AFE85A", "A9F34FFDC815E0D7A8B64537E17BD81579238C5DD9A86D526B051B13F4062327"},
		{"000000000000000000000000000000000000000000000000000000000000000D", "F28773C2D975288BC7D1D205C3748651B075FBC6610E58CDDEEDDF8F19405AA8", "0AB0902E8D880A89758212EB65CDAF473A1A06DA521FA91F29B5CB52DB03ED81"},
		{"000000000000000000000000000000000000000000000000000000000000000E", "499FDF9E895E719CFD64E67F07D38E3226AA7B63678949E6E49B241A60E823E4", "CAC2F6C4B54E855190F044E4A7B3D464464279C27A3F95BCC65F40D403A13F5B"},
		{"000000000000000000000000000000000000000000000000000000000000000F", "D7924D4F7D43EA965A465AE3095FF41131E5946F3C85F79E44ADBCF8E27E080E", "581E2872A86C72A683842EC228CC6DEFEA40AF2BD896D3A5C504DC9FF6A26B58"},
		{"0000000000000000000000000000000000000000000000000000000000000010", "E60FCE93B59E9EC53011AABC21C23E97B2A31369B87A5AE9C44EE89E2A6DEC0A", "F7E3507399E595929DB99F34F57937101296891E44D23F0BE1F32CCE69616821"},
		// Large multiples
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364139", "2F01E5E15CCA351DAFF3843FB70F3C2F0A1BDD05E5AF888A67784EF3E10A2A01", "A3B25758BEAC66B6D6C2F7D5ECD2EC4B3D1DEC2945A489E84A25D3479342132B"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD036413A", "5CBDF0646E5DB4EAA398F365F2EA7A0E3D419B7E0330E39CE92BDDEDCAC4F9BC", "951435BF45DAA69F5CE8729279E5AB2457EC2F47EC02184A5AF7D9D6F78D9755"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD036413B", "FFF97BD5755EEEA420453A14355235D382F6472F8568A18B2F057A1460297556", "51ED8885530449DF0C4169FE80BA3A9F217F0F09AE701B5FC378F3C84F8A0998"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD036413C", "2F8BDE4D1A07209355B4A7250A5C5128E88B84BDDC619AB7CBA8D569B240EFE4", "2753DDD9C91A1C292B24562259363BD90877D8E454F297BF235782C459539959"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD036413D", "E493DBF1C10D80F3581E4904930B1404CC6C13900EE0758474FA94ABE8C4CD13", "AE1266C15F2BAA48A9BD1DF6715AEBB7269851CC404201BF30168422B88C630D"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD036413E", "F9308A019258C31049344F85F89D5229B531C845836F99B08601F113BCE036F9", "C77084F09CD217EBF01CC819D5C80CA99AFF5666CB3DDCE4934602897B4715BD"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD036413F", "C6047F9441ED7D6D3045406E95C07CD85C778E4B8CEF3CA7ABAC09B95C709EE5", "E51E970159C23CC65C3A7BE6B99315110809CD9ACD992F1EDC9BCE55AF301705"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364140", "79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798", "B7C52588D95C3B9AA25B0403F1EEF75702E84BB7597AABE663B82F6F04EF2777"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141", nullptr, nullptr},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364142", "79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798", "483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364143", "C6047F9441ED7D6D3045406E95C07CD85C778E4B8CEF3CA7ABAC09B95C709EE5", "1AE168FEA63DC339A3C58419466CEAEEF7F632653266D0E1236431A950CFE52A"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364144", "F9308A019258C31049344F85F89D5229B531C845836F99B08601F113BCE036F9", "388F7B0F632DE8140FE337E62A37F3566500A99934C2231B6CB9FD7584B8E672"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364145", "E493DBF1C10D80F3581E4904930B1404CC6C13900EE0758474FA94ABE8C4CD13", "51ED993EA0D455B75642E2098EA51448D967AE33BFBDFE40CFE97BDC47739922"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364146", "2F8BDE4D1A07209355B4A7250A5C5128E88B84BDDC619AB7CBA8D569B240EFE4", "D8AC222636E5E3D6D4DBA9DDA6C9C426F788271BAB0D6840DCA87D3AA6AC62D6"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364147", "FFF97BD5755EEEA420453A14355235D382F6472F8568A18B2F057A1460297556", "AE12777AACFBB620F3BE96017F45C560DE80F0F6518FE4A03C870C36B075F297"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364148", "5CBDF0646E5DB4EAA398F365F2EA7A0E3D419B7E0330E39CE92BDDEDCAC4F9BC", "6AEBCA40BA255960A3178D6D861A54DBA813D0B813FDE7B5A5082628087264DA"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364149", "2F01E5E15CCA351DAFF3843FB70F3C2F0A1BDD05E5AF888A67784EF3E10A2A01", "5C4DA8A741539949293D082A132D13B4C2E213D6BA5B7617B5DA2CB76CBDE904"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF8", "D8975566D098BC58D56AC778EB2445A8BBBBFEA11A70E0AED7258D899E1C0613", "94E691957255FF0C5F2D79BBCDEAEA3C25DF63C268A10AF2E43E7B90E57E9252"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF9", "0527CF8A882B7A8335CC794152791AAC0A2E3580F2375C4EABFA99861C8A90C1", "AE4C367F859C2FE818492912A3237E0C33A5ABA4E30874287281C44C5C9F032A"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA", "1FF4DDB68AF6AEB749B8107B38D76108C0C4562F8EFE6087E04575305516CAA5", "991A7CCA5073B7F44BCC834D6DFE90EB155EE54D774122E3B9387CD26B7A7156"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB", "64F6309019333DAF98303B4630EFCC46DEF0C895D16F830D140C833947F00E1B", "50E58E52650ED0DC8BB1D178A4B14187B4FD9EDC98A29327B5F2A7B4E6108115"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC", "2CB62EA7395B82DF182570F2ADC7326C7CC7FE8D1DB31A2071C5E831E3B0DF74", "A0FADE1641324FC1E4DE38568CE5124D9E161A82FDBC40F2DF4AADE4D58DCF56"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD", "3FBEAC6EF73D496E597DAB76C75848E2633CFE3A8492B360D7A21B223AFCE95D", "1A9128BFF344CA910E8334027DE4308B3ACABCFE6B9799C7A0BFDE45A6FACF67"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE", "E0A65740C1C5148111A8305938C56322FBF345A18CB90CF48A788961C6B3FF91", "8AAF0580FD9E8BE571E97BEF4A067FA7911DA0FF0E1A5F307FEA63E3ECD903AF"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF", "9166C289B9F905E55F9E3DF9F69D7F356B4A22095F894F4715714AA4B56606AF", "F181EB966BE4ACB5CFF9E16B66D809BE94E214F06C93FD091099AF98499255E7"},
		// Random multiples
		{"45528A55356F7C32CA753F1E58627BC33863670A1072D9C8DD0663EB5691D87F", "86F12A5BDA1DB7F296B4F1545E417D2DABB28C1E7C96475B97D5AEB9FCAD71A5", "2FE6419626EB949DB7A6439C6D54A78D42AA596ED74F117E51A6E1CD7AF78C1A"},
		{"11D6DD13D560E703C7F0189140DF2F692B603EF57A5E10E29C3E163ACD1E8FF8", "E222674C42D1B962E51F11C4138A6A75E5ED73D16921C7D381DCA0692B2C172E", "90747484C1616B024139138492C716092E41F4A631015196022330B3C5BFF7CB"},
		{"E1E1DD6FBA9D293B4F5F46BE5A3F05A7BCE9CDBD8993BC0282DCF6B975D285F1", "75608FB5896949F01C5AB5C655C55B91E56AA40DEB0B66DEA9BFFAC718A8BE42", "5C75D5CA6ABC9F8171E6BBB4EF9B1BE632A2FB25BAB0E345548505ECC1F3A45E"},
		{"3CBD5DE8E80196F3F5DB4D925A29638E4BFE4A9A848A9424BAD5C46136837C1F", "A964798AE92F981676341BED95E95646FD357DE2929666FA967F605F3FB1C739", "06BCBB55BF3C38660C778029A64CECA44BD7AF9AE346164FA7BA5A99A292A899"},
		{"EFA4125849134857FBC1A97675A43B5DE6C1D268E2CA7AB1E179DB25F13DE00C", "4E3E7A7387C7D8AB2F90DF43191F2CF56FB4F09BF1B1ED66501E4E231E4D65A6", "855323DD2B0BDED7E96E641A97B5E4D1BCC97EA2A4453BEC003208C18896E9C1"},
		{"B177E15F7CF844C240A7749F332DF50A692A372D6AFFD786629686540C8E73F2", "79B63C33938948A2BEBF8670ED0A21AF7395584D644B0C7F2667A9672030B199", "089FFB15F84A98BE1BB2FABD4CFC9FC2B748EC158974D1B5A9AA5191ECB7E7D4"},
		{"9806E0E601FDE9777CFBA9BE56FE90453023E6B08F5BE6CB18555156DE3AB5C3", "2F413CA9CB2A6E15120B1FCB4F57E907AD3D54E5034A7D7D7EFADF59EF5BF50F", "F83C779A884E36D307E6B588B53F62A6407D6F8815708D831AE8102EE26940F3"},
		{"B26C14ECABF65120BC8786A981EDAD985E8C1D42B146D7F66A8759919B02AE11", "D5E97EFBB234E24B4CD39D59062E925A355901EE4D89899C638B4CD9B16CF829", "AF21FC31E958C61DC1C6DDA55E99444BF04E55940FA71B891540AA4AC94DA3BF"},
		{"F56A9E89525FF39CFE2D18BADA4E050D0875BF2A2C97237BAC9B0F31D191E250", "95CECE9600B90D3352E868A5B497F9D134C05A882CB1308FE583061DD6C59F24", "FC8B7A4555770FF9E05A96A3828141AE69B9B89A8E06DEA1D5B6DA42C95513B8"},
		{"6C2CE63745F8D521BF120F360FBCDC56C8411E177AB6637389E18D289257D435", "222D89AD4CB409AD7ADA41AB280D8D2BCC723DE7B8521CAFA03AD8C839D6CBD1", "C26957D3094F04B394A45E3DBCD11B631BD4F473D293D85E7E92457AB2F23737"},
		{"9CE2B3D4ECBB3CE8CBFEBC365D5B0EE3D1DCDE114F0A7944CF357A770D27A5E5", "0F92952B176BB2B66B7251016B6EF3A10979A7DD20E3DE017498F339B7D47740", "CE2E23AFDDB77590D6F2B6DA13AD70FA212B89A885FF44545CF7EADE9DBD1627"},
		{"8E237B486DE3BB3156BB7F1493F31E5709449113779B2E70C061BA6EC748DE5B", "62D8F6D03A41EB698D845B27E1CFD862A6D4E178B55DB4979AC0B01A84599E5C", "8B1926377D460E2A77F0687741DCF5E7B720A24E8189FE2D1706055FA0727B49"},
		{"BA83B8BB8081B74DE6B7A2F24D9AA80BEB36A8F3670F62715846C4B66B6BF55D", "8A841F13C93473387B2D6DB8F43C82EC80A561DFF790D0C02F54AC6E8BABE596", "981B5EA656254E84EFDB72552164DEAE0E6C452ED2A462763DDA1DFB7431775C"},
		{"1BEBE58F680EF4F9B05904AD0A06B28DA2796F5FCAD0EF7A6156DC5B981C89EA", "04F307974E735568BF7ED84D6D9E47C8CBF78362347216103D599233606E02EA", "EF06A534B729AB791C13F93567DAD39BC6A85EBAC3E607AD1045C4A2EC45ABAE"},
		{"FA4BB94494E7DD1FD59EA728946E17434EAA6D5E0B9BAE191581C55E6A04ADDF", "A705FDBBD5F8C8F64BED6F13D667357ED200EF4738FAAA9D253A3687C0F3E194", "14A40DDD8053BEF96529E8A6E4D96579AF294FEC43986AD483302250A91CB52E"},
		{"F30C65DFE796F9F5E72FFBF00A5693F69BFA56D4A9ABA2F12A7F19000E7D2884", "1B24B78E17D1CCC8BE2B901DBF3C9F36C3D0BE35A30E29B9425C17D06579C3AE", "5EE17B92E7C33F4B4376316AD409CFA729872F06AA70CACB3214B054FC17005C"},
		{"DF3A3DC1913CEB70718FA0A07118454B8D5CE9894E0AEF5E40DF7EB55E32D9DF", "DA4316FB9D85BF0485E0CE6380B99210F8BEA0CAF641684F98EF586BDD1295E5", "07860148AABDB47C310DEDAE95116E40858C1A0E2DD296D821618B3D822ED9EE"},
		{"771057BBA5B9C168F34204651C9BD9948CA7F819B717F213C020176BC47C01FE", "8BC8442E4B445DF8AE1A723104047B5B599A495A006521041D49819D9BBC4DC3", "CD655AAC8D8E1C69FFE8142D12B6445DA7CE239F115C63DB3CAA688C68143C99"},
		{"815A1EF6BB5458AD1567571AACF0B7DA2FB5D4307CB52059B1211F3A40469E0E", "C7EB10C596CD9AD02970170B8CA424C310A123589468E615AB1CCB08C0889F67", "26C39AD0442D3B294345EAEDA3316DC8BBE5FCB91677068CA6BF4E78D07CF2E6"},
		{"866924A28917A33FE144DB60B4D7A27F1DC8B0D26D63372F76E629642245A76B", "6058612C8520CB807E753132E14D497BFD9EC74B172356E5DDC78DA1D2AA97A8", "4EBF15D5285A619C6987D47079AF89E544C7987795C427939BC5728663295FC4"},
		{"FAE4AFECD392E1F88EEB28B8FF0C25569530B8DC7141B8061397AED9A49CF9F2", "F46E371AB5FD98A0ED4B15C92CFADECB0787319326A7E561DDD8A6C6080F8642", "1D2B15146F7A7171A1A2D66FB55F50AD970122E7F87F3754A6016D0A52818DE0"},
		{"3BFD4640F65AE89E5E46B027D969ABCF046AF5BDE20F8E923787DE6473811965", "4BF1E32C1B69D7E0B95726EB8DCF293FB9AFB5F4CBA7C00F95E2CCD4EE0FD14D", "725352959BE783B2E64055F76FF1EACE840FA43FA8F72DF4DB0889FF3E997DDC"},
		{"3DD6E832384E4C1283DEBF1CD9AF94484A6A4458D7FA88FCB853317E923BFEE1", "488CECBFED358EDE1CE51FCB9F2B34C23F7FEB67A800063AB8212871E1941D13", "FBE324AB8FA3C3A3B6D71281FE4555AC80689EA29453F43445D8B74257039F13"},
		{"CA0CCB9483483BD0601220B8A1E5A2F93ACAD18C794C9EB14C8AB7D8A4001E2E", "8013D6BC2F12A279617C93DE87FE85AEE7A9F82BD01274301DA32126A3D5E8AC", "BED9ED257D0CC0B956F192BCC1F00190A7D0293C222648EB600D28FB3F22CF66"},
		{"9C6236188056AC2CB99CC60FD38CED951590E004282480883BC88B74A1EAB3A7", "8333198B3B42E44586A25F0CF5371133220703B44C9B7612FD83ABBBBA4F78D8", "4C633A0CA354671CF632ED36F749C66BF9D979414ED52DCF04270A0A60224C7A"},
		{"F563BBA48829799D3D60E66AC9C0537D1DBDD32A1C2D893153A8384FEB0062D8", "2EE54FBB45B4B7A0BF8C5BA332B898D7AEDCCCE1B3E4CDA56872FF77FB1F7A2C", "7D5B84B9C5164DF9979C5DBFD6FC31D112939F196A9A437329A36742D5E51611"},
		{"406DC83D14DE5D2D272C480C42F5988AD6154ADCDBA66F1D03E7AA36693FF7D3", "D706B8D7ED2E83FC7AA5284DE94EDBDCAF9FA0D2E1F1C56341F1FBCC570B5612", "0EFD57AA3345E14F4F7F290C0FC924FA51FA2A069C8EC961999A2819C0ECCAFC"},
		{"B9199737B6E6C3126BB68D37E938ECCE04F6ECBEEDA1E9CBF10AA6138B5C842F", "7943A0C63E51D571184B2469BB371F4D5A2A66BB32E7BB44EB4974882BAD8B76", "9387384D13291F8DF67EC5EC862F1F5372503771811D5DAA4EFE190D75DD1A39"},
		{"4263B3E7A22922C05FFCE2E922CEEBC583B7E5C537C8A4F3572DA96BBA8813CB", "F1335E670E5CB076BA973C92B24C87BDA85B962416539B2111A4317B4BE9AE44", "106C70EE074A552FF61D885616003A1139D86A2845464F59C742677464DA2110"},
		{"F750484A92E6ED351C6D5CC9738085F62C5389C11E7C6BDFA292EFAF20D0AC1C", "3CA82E74725ED3A9D359AE58D094D2E5C327B3F7B1671452C3517842538FF204", "9EBA56838328AD2FD2091050C8DB174B7952B28CCF9E322E2A006958DA3FB625"},
		{"6E139E20DAF5E0F98D0F21B7648016579809019F9022DA7334EDD864E7916B3D", "46F45C0139653C58F80377522F5E43E53E16045A88053AC84A00FD5EA6BFEE7D", "743BA29A19E2F118037977B8A614D8DC2427D538C7198632AED237D48E6FE9DD"},
		{"1B4B9E14EAB0F76F57B01E1155548FF0CA5AB75C7B28B0EAD962662D875C6B74", "A173D134375B449EED2D28B941FF935EC3FCF66255BD6FB10CFD52C219E48812", "133B122DA45CC3DDC3E2B5C02E9D86F0AAF4FBE564EF5FCBA59CE87858569EAF"},
		{"098FF774AF194BEDF730A2E3E42D6BA9DCADA504B1610133296CFA4DEF20CE53", "3BA9C946D318B32252B212337E7DEAF1127FCE02210CD2E4487C28CE8E04307B", "4C5D9A560E8666AC90BCF88FD39A0BEB4D302D9B7AD0D5683A2F8D32ACD7C988"},
		{"02B36516F5976CF6C3CBD5D5663DB4E1C93DD67383EE79627BE8A1F2A93ED0AC", "FD01FA210DB77F9126F7559B5E0AF8927D4A4C45AE5233BAF025E5596AA13C58", "B95C7D1519CD85E075AE293A0272A7AAF2CB97F29B64A351A2C512CFF7DF6B49"},
		{"204FF2CC9F835A21B2FA49D7B3B712B6ACB2E3A98E1EF0326F7965DDE8E1133E", "9EDD38343D35B22C057D37199FBBC530B96E630BA7B4C9A7C5268CC38D626787", "2CCDAAEAE19F3A0A5FA1B2C3C03984DFAD390262DDE254832A1BFB5E4860DBE7"},
		{"C1D10168789CB7EAEDB80BE73491B572E8866F9C6A8BE13A219611D203E96DB4", "AED9D3D5B9DC1830A567A837F4ACC1A04EB5530BA7035A72C013F54E292834A4", "B967438FCEF87D8BE5EEBBDB336F7606E852E7229DC22DB14BA2B17FD7C9553B"},
		{"C279603B48CEFC3BDFAAF80F5548B11612C4BCB0746B19915977BB9B21C5F718", "ACD33DFB09D55BE1A21729408DF603253B55087555E4012D677756A02278906B", "660650032DBCABA6CAC73027FF78277287A7FBCC6CB4B4A769F4FDD6EC5F5C11"},
		{"7BCBA36D1148C7A5AC938CA14C19A947E69F230577C182E243EEA7539E5C544B", "7B5D4B743D6FA328DBE32D49C276B123C04887AEAEC01F117582E846F6F2255A", "35C32C24B0499A3968CBD609A32EB3627EA99A5798BF50BE8B28608BDBE5FACB"},
		{"59B5E4509B28E1EA788C777C73337E4DC4F465C8772DAD204C8EE5FAFE2D4645", "51471C106EE9BC9E4D46ACF6409FA3C13787835080B2FE921BB2CCF9699636A9", "8272B678EB7E805A0725BC709E2BB2AEA7F10F3A53DAE3512D6DC8EEBF1D137B"},
	};
	for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
		ThreeStrings &tc = cases[i];
		CurvePoint p(CurvePoint::G);
		p.multiply(Uint256(tc.a));
		p.normalize();
		if (tc.b == nullptr && tc.c == nullptr)
			assert(p == CurvePoint::ZERO);
		else
			assert(p == CurvePoint(tc.b, tc.c));
		numTestCases++;
	}
}


static void testMultiplyModOrder() {
	ThreeStrings cases[] = {
		{"00000000000000000000000000000000000000054C9DC1717D84540608A237D9", "0000158D3F4383CB7CAC54E74928B4BFDF58224F42A01A4C6318B0A3BB2BBD4B", "231F5FC63A0601A4931488454123D6461C58D63A0632C5705005B631A8FBC8A4"},
		{"00000000000000000000000000000000000000305E992F03907F26B287500DB3", "000000000000195BC7202AFEB9CA33432E3E338DE729525CD336EA7D4A7B4DB5", "86035A47723E45D64472BF5785CFA256A6619271D0B3D3C3BE741FC4B0B84AD7"},
		{"000000000000000000000000000000000000003A6032550A5D6324553E1B6F12", "0000000000000000000000000153212C248BF7D55E31087A3AA913546B645697", "4D54F31DF7C870DCA7CBB5643DB2E9841E2EDD8AD2E684D507119330C2868F9E"},
		{"00000000000000000000000000000000000006B04BF966C3987BA141FD68C8A0", "00000000000000000000000001CD1FEDC181822A2DCBF8361C6EF8BB2B99A0CE", "0C4E5F95E31359063413213A10862D0770739338E6F4B747C30F2D146CCA61B4"},
		{"000000000000000000000000000000000001C3640908994650F6D28B3DFAA264", "0000000000000000010104886AA2C7ACA649B976C442AA4CB24DED88312DF3ED", "3FAC44C0F58C2EA3D69EB77041356381503098168C3FA6CB559E3C9AD9CE2A63"},
		{"00000000000000000000000000000000000324C8E1BAC6E3A45882124257AE67", "0000000000000000000000000000401BBD0120C2E48FE73946F913FA294C6131", "C9896BCA5AD974A301A035F01ABA482B9EDAE2BB186DF19CA006832E317168B7"},
		{"000000000000000000000000000000000004FF3468B8C2727F1B989CDD24DFC7", "000000286B60CB514EF7E9DDD026ADBA6D066A7C9B281432ABC226948B0F6B83", "5D68BB266807CB927462D144B70EBBDB5D772FD235B1487B996FBE31B3ADDD3E"},
		{"0000000000000000000000000000000000071EF7B5ACD4FEDB970E884A39261E", "000000000000000000000000000000530646098F12EE8BF4807FE13C7C29171C", "024F36FC711851731185E05AA0CF08B32B6E0EF8DD2DBD047762B438E37ADD48"},
		{"0000000000000000000000000000000000081375508BBAB588591F5CB1734D66", "000000000000000000000000000000002716480EDE527453F069ECD2ACEFEEBB", "00013BAAD14B47FF0A6A957F6E32F38A832D4320D042B2303DCABE009B685D82"},
		{"0000000000000000000000000000000000093F3BBE8B96205CD277189A1CA58C", "00000000000000000000000000000000000007A359D8675CFC557A14F3BB734B", "0000000046A1240CFF6FA694A1B3DA3C29D91F287C2E521D8F085C70D6066404"},
		{"00000000000000000000000000000000000B913ABC721053C522DEAF59EDD912", "00000000000000000000332412BAF8C3CBB4731D7DF3824A3008B296F2AFCFBA", "1CC1A6B05AFEFFB9030DF5FDDEDF78E25B68E2FE1C757910893D0CE5061B391E"},
		{"000000000000000000000000000000000017F80086B7998F0F69127C3355AE7A", "000000000000000000000001268A1E5C20E9234ACA25617E85F640AD48359DB9", "22AFBE2118052D25873986866A9B0CE6C48D8AC7C8DED8AA9A134D26B25FE5AB"},
		{"000000000000000000000000000000000174C12B61D8A82D35A53A3F6BFB9E94", "00000000000000000000000000000000001EE0A9C5CD31F35A8430E18840C358", "00002CF5C34EF612ADD4685BA72EEC64094DC283B9E5839E6F9520480D493EE0"},
		{"00000000000000000000000000000000067545C860A9B9B5B2D50598C83AE0BB", "0000000000000000006A62AD5E3537C65B526D7E057577A003A9C8336D132597", "6A0039A8CCED4D86840BC5CAC95A49C5C9E3505645A0CBD774A47D2078E98A4D"},
		{"00000000000000000000000000000000B842E2E864157CEF8A5370455D4AC6D1", "00000008F245A84CFF0342DC1BD7DFAE1909F25E51EABB211C349807B2E96EBE", "D6CF6D1FA062CCF0768BE03D4DF216134AF2399D5ACCF10D135D3C079A7CBEA0"},
		{"000000000000000000000000000000017F9235B60F284E6FC389F694FA385E99", "0000000000000000000001FFD13D83845D2C1ED68559AC13DAF2E2F136250774", "D4B02A359DB1DD32FCE933CECB55F1C6DCB4E2C398D61430510E93DEEB65DDAE"},
		{"00000000000000000000000000000004895028EF3A2AF3AF82F8F7F1A1754A7C", "00000000000000000000000006CF999B8481BDC02DE736489821A355E8D4EE26", "19E6B05500BFE91B1695C0BFF2FEB4CA6C70F61241009555B3B0747E84BC758F"},
		{"000000000000000000000000000000375CDCFF01F61EA2F8E108D1EF19AEE89F", "000000001C24F3255F17D0BA0996D5C1726E12D6E2D921EDD5334AF4B6D38959", "6744B7D3C9F85F78F4A227D879103A1F4EF3F83A3634E751C3EE3C0AAC9D97D1"},
		{"00000000000000000000000000000047EB6388C2999EA61C6E01F31A22260A0E", "00000000000000D6062C69E6C0397F0265A3349AE3CC9FAA2E6FBB1891F1CDE1", "6FA5CBD67569D8568CFF6A2E163382F03A06CDD7499CCC0DAAD8619A8C86B39B"},
		{"000000000000000000000000000001ACB971CCB56CF2B865B60E5B5BC9812817", "000000000000000000000000000F6E5251A0572C9579FC1181C7192D87F4BFAB", "FE3DCFBB382731B381E5B61A4BB1941E6416446CFB6F45270E1FC58758C10EE8"},
		{"000000000000000000000000000006CA54E90D3827EA670E69D18B034119C4E2", "0000000000000001CDAED94C9DADC6E1F05D56CFF12F9F1A6AB01745C4B6072B", "F530AD2660DBA512E9840F69CBBBDBDBE67B97DC3F55AC3435FF19BDBCC6D794"},
		{"00000000000000000000000000000D8528FA8BD09DA634EE13B37D8EDB142668", "0000000000000000000000672F106E7C374ECA623F7EA3D943E252862B3C6F05", "BE5A99B8FBE89A12E1D9FB90FE3627BFEEDA5DF20E0B2A6CF29BD488A3C3A43E"},
		{"00000000000000000000000000007CCD4701D24F10FC1ADE727310A7B0D883CC", "0000000000000008BFC99A69DD3327EAD650D1D53BB1064DE16E1F5185E08744", "99209F9E30BF196FD668EB4871DFDC2334CEC425431B213784427BF2308638C0"},
		{"000000000000000000000000000135A4ABDB0AB6C8903D1512C8CDB8BC37B803", "00000000000185F85F215EF6397DFE076F9B4CE41CDA55D80DAEE47D1301D692", "E998E6383CED4D946A789E6A53488E0540A2E9D90C29D746148067F117B6D65C"},
		{"00000000000000000000000000013B32312519C8195F6CF5E317C062D185C155", "0000000019ED7F9C7F40A01B7EAD61AFEC321FFB39C83B238F2B297EA4B1ABB7", "037BEE84685E8A9839490CAA7030C76DAF9CDFF85574C5A97C3919D177796B5C"},
		{"00000000000000000000000000017379C46D327959F966DBEEAAB778C7EB7AA0", "0000000548F499FE4E81F1459CAC8DCE325F9F5063B6A189CB988A2F498649E4", "106093AADE816610078EF0078E21A0268ED453C7CD656BB7B5A48929C15A1CE7"},
		{"00000000000000000000000000071E6BAC01866A5FDE9C0D2CC2EBE286D42564", "00000000000000000000000000000000001FD134A46B01AF184A4DEE4EA1B1B0", "80567BF2331C84C614AF9292F034083D0F92F2CC96FFBA0EE94F986D8BB23D5E"},
		{"000000000000000000000000000FDBE31A9E96BB03938AE179FDFEF01BDD8FED", "00000339BE5C78AE92D092EF62E06F34720F5273C26DCA7BB8F32A1172E13E94", "8C32A55227B39FEAD4FE13DF78D5AD7926FA2F4087F77AEC2787CD4A54FCA753"},
		{"000000000000000000000000002DE6CFCBC1D4F3786F95BD17F2763039D35F58", "0000000000000000000000328376858CA07E6F8FB1E5AF38D0CDF6AC812B8DBF", "E0C02A64B2071F11E49E078F7C4F4EEE59237480F563956F9B2349AFE07615DE"},
		{"00000000000000000000000000C62494C857D13446F3B370A6B03AC9BFD07596", "00000000156FD3391A93120734EEECA1548AA7C0C295627EC8EA5AF513BB8EA5", "67FC4F95ADCE0F7D5A1A86455B5DD3934E72FE40D6F0BCAA285CFEED28EC1E6D"},
		{"00000000000000000000000001846F2D77BF2627E58BEA27C02A8A1B03274288", "00000000000000000000000000000000000004FAC2E2A4428AAF0EB8DA80C8A2", "8E38FC69C456AC32726331ABD25A7A851299811BE11A7EE0DB142DBE0D569149"},
		{"00000000000000000000000006A2748DCB0A61D1DB7637DF2D048150AF59FF95", "0000000000000000000000000000AA103D0E087AC8B2A8FBB8800C09684DE257", "0101930A9D08BDB639A0249F170A2328A64910DC1577E38000B96C7482CFAA91"},
		{"0000000000000000000000000807C30EB8A6BB13F6F1CC251F8487F856430DCB", "000000000000000006E0C6092EB97DACC3CD4F8EB602230C2C37920AA3AC4C4B", "BB6F1C3DE9280A8A9523006637106A6DA2371875454CD4219A25D5787C14ACF9"},
		{"00000000000000000000000023AAE00DEDB3CD0F5A92DDCEAFB7063ADD4B1918", "0000000000002C471BFF33B1AB0B99821858EC7394998E8B9EA6D786D7C1CDF9", "001548699036095D7061FC19A8A2095E73B97E7D61F2641FEC6ACE1DDB3DF7B3"},
		{"000000000000000000000000670873173A6A208185F448EAEF61B87FE3134D58", "0000000000000000000000000000000000000007073E147DDC58E8F84E1749AF", "D4255D136BECFE9D022BE1A0A17B621E24F36D294D03C9233B7CCF9FDDBB74A6"},
		{"0000000000000000000000027AC4D06396AED01898F1EB173D037E6E97CAC3C6", "00000000000C2C7D1B5169306BE4267B989AECA85409E9E3FCE19AA5A3F85CD9", "5414A1CD93217FA34005F23F822E5AE55A8A4FA47BDD8C1212728458F2A42456"},
		{"000000000000000000000007781A865648C6E59229D84CD1B2EC579B2736248B", "000000000000000000024DF37ECC6DB2220CC8D9C9FD9889AC06FDABAAF0BD8B", "BA04222907E35536928E784E10064E561071E797EA02E6E8177A812413324578"},
		{"0000000000000000000000115C394478A07D11A056704088AA02EB9000FA12F1", "0000039369AAAD3D7BD8C1C01ADAC5F7B6C4513DEF667F9D02356AAEFFC7A1A7", "BC887B5C5510AE93B9A9AB386EA291D639388CE352200608E7F759D9E2AC40E5"},
		{"00000000000000000000001AB58FAC7BE1CBB3D998D8A7BDA436244C8A9BB39F", "00000000000000000000000000000222AF8ACBEBB30A2C0FD609AD034378EF7E", "854445B0840B16EDB28FA57C0876CBA385AB7D90166D99D6F6C89792AB5E705F"},
		{"00000000000000000000001B0F8C4730E341B529F4F907C890E2D3655711EA56", "0000000000008BF5339EF21853DD173880BAD81D76B6ACB4F629EAE3EBBE241C", "692AF26B6056BBCED5F525876A8CE1353AE08D0A85A984A2B51C987B7AAF9136"},
		{"00000000000000000000002BBFCC3E401FAEFD962A591B3D4B51ABDDAD7A6A5D", "000000000000000000000000000000000001167BC97424BFEF5B586A8DB76E14", "602C1869883317B1013BFA82A4DF49B9F9473F16BE141B24DBB6D7A125CCA315"},
		{"0000000000000000000000565FE78E4ADE3AAAEBFE2180835C0363C91B0376E4", "6D4EA3B13B760B5952D40AC540A6EF791B203702B2A99AAC0CCB247454CFA520", "29463FB13EA2684DBB6322FEE5F64410A032CC724416A17CD53008A6D4B4F32E"},
		{"0000000000000000000003860B3EB21F6104B172E0630CEC40F3D00FB996F997", "000000000000000000000000002C45F1D9BC859A3248A6CBB572B9CF5F3E1290", "05B8644BCC1B08A76A341BFFB0C1F13A515B81E9D176D0F8D2C4367AEB5BE8BE"},
		{"0000000000000000000004870048BF1B9EDE6B18409D1595C191995BBDD9C4D5", "000000000000000000000C4FA590141B4B16D0F02325B32CB43CF1D14802C978", "51B60DDC96275FD460AEF22EF6CA875459BDC34C2324FC632EC54F2D993BB9F7"},
		{"000000000000000000000AEA531880D942B7ECBF2F6ED52849C910D7E4A2D43D", "00000000000113AEFC659D29D1C3902EAB46ECC46A0D8580D943424C6D20C8F2", "8DC88C23F2147B92DEDA2CF12C77EF84CC515379D05629C077159693170CE2C3"},
		{"000000000000000000000B2CC9C03804857B6CC5ED85881A545488E23388BD27", "0000000000005FAF365838BB2A24534C4F4B2D452DE63223F52E75A32A45E62F", "65D188BCF7D7C70FB034984FA73F453DFF81B19F0665876C7CBCFCE88D37F402"},
		{"00000000000000000000B5B1DC197CEF644B622E6BE576DEDD3C55B09F186A23", "0001B9EA5761CAA4779AAA5C23E33959069FECA0CAE406E7E4F345999D8F4F95", "403FC56E1749E67418C68047C50587CAE50AD9F06EB7C05D6BD17DC280D2E292"},
		{"00000000000000000000D132929CAA0271021B0443273DAC0737F1BC6D79F8C6", "00000000000000000000000000000000CCE7E292D089087D8C0DD73BB266DEA1", "57D0B0487FF9B092665B00992067B47395BB9D8DDF027A9E918B1F8337DFFF80"},
		{"00000000000000000017F9D96FCD58FC073B44924372CC0BBC44E7709077C30F", "0000000000000000000000000000000003A3BD318C1905191F484C5E22D3B59F", "672A3147B6EDFEE3A5C6CBF19CA328601D3E20D3C2D9B1EF61C98924C88906E3"},
		{"0000000000000000001B385C99A473E01A73611CAF68313B3BBF8088605F5A2B", "000000000000000000000000000000000000001B9DA443A1D85513AFB4D2E7E7", "4ADA301A10F4DF7DEF131A1D83EB4154DDC3F0FD0661825D125BCE42B4E07601"},
		{"000000000000000001689371EABCCFD2C14F38F71C3A02F15BBDB80A86888EA5", "0000006971E70FB6A37B6A0C9C8104EB5D50A5BAA6F56F1451BB2551B85ADCA4", "A371F3D35E9976B3D1608A7E20BC05DACE7628116FD5D8C998546BE91F663E77"},
		{"0000000000000000074D65B3D91284226CA6151F357ECB17A06683F10F1A7E4C", "0000000000000000039977749E784A0D2B164AE52A63E960FFE524DC43CAAF6A", "3D31BA32A40C07E63F99DE6C8C67875967D1739A386FA00E6332BBB0906C3953"},
		{"000000000000000012CE561F7476091ACFE261B29A202BD7AF9F332B00BD7639", "00000000000000000000944C435C67E84A82E9632C20C2AA543416DB8B2D4503", "93F24D66EB4C4AA6059667E2CA7C9D3FD86D5EFCAAA37CD417083060078CE88D"},
		{"000000000000000018473507F79AE6F9A3D2765742A8BFA790CEC6DC59EEBBF8", "00000000000000000000000000001ECC21414022DEE19A925045B0617EAA805F", "E03F30946EF4EA47230A1FF1059941CC5F2E7FEA5475472A656C9B3B8CAAE59C"},
		{"0000000000000000350DDBFE935CEC33708A9FFA72A207283CCCDC75DCDB4D6D", "006894037D247140E4AC7F6F74362BCE08E518F0FA5AAEE5CB78D89E3A120926", "D6880AA19C609D3178D1C97D88FDECB8B3A1B7F8743AB05E8756CC5B28A92761"},
		{"000000000000000065790D6ED8A9284C7CA5DA112DECDEAEB9FF7004BFBB1233", "00000000000000000000000000000003A02A1BC883C6E0CF371F44586D5E51FE", "26E399E7155AB899CCE059A63022F8E38CF021C556A308BC23F49B341CE25F75"},
		{"0000000000000000C1FA5040C304CAA9054FFA2E3759518CB524560C77E778C6", "000000000000000000000000000B9580787A79EDA59D8C5DDC372D7A3A961A82", "8AF31479FB6C446CFF7B260EA178B2E93DF72B754632D01C410CF81DA80F6480"},
		{"0000000000000001ED88070829447CDD08E07A45E6382F54EF0EEF72A566B240", "000000000000000000000000531C3CEB1C50EE2D29E7D52BF308016E018B4F61", "7A60856EAE610A58EEEE4D6D0C77A7C67F8066C3B97F7947D78C4A955A8856A1"},
		{"0000000000000002121FC67592C4538B67EF0F668B1ADF74E3D970C19BAD0B01", "00000000000000047C83B8A7D5ADCB3B74E561BAFBA5EFC40E15E40F16AD1CFE", "68EFF3E9B9B91030D190C40437E859D60C651516E14866B501005696C26D38C4"},
		{"0000000000000002A41B114B97DB38330327AF95C4A5A13C77EDBA422B5F2629", "00226E3AE7A9EE8D571EC3D3C05A5B3B37C8BA1AC2CE36BDC4B6C7B30F673CDA", "0A952B28AC856249513AE0E1F311856F05443878C0F751DA81B30488A828E6F1"},
		{"000000000000000353398FBBC1F1AAF4AD551FB7495F478C8C04006AADC63550", "00000000000000035E35F68D8AD9648D2130CA460D8C9ABCD58DC8A672E78810", "A4BD65A65B321FD66C511B4C152B914F60A921968DFE750AB0396A85C42EE19A"},
		{"0000000000000003916E39364847380F8B51FF0BA1A66ACA083A5433FC34CAA4", "000000000000000000000000000000004685E9757C617651C735AB8FA145F8EA", "CC5DC2509B3E939C5F739D512A71F99A59C8AB947DDBC6A0C9D6B1F357362AD6"},
		{"000000000000000592C84F0B63ED0766E3058887B9C23FACD341A16BAD3A9378", "000000000000000000063FF4B090E55D67534BE58902D28A233A52B349E0AF12", "6CDA19B4159780D5C0B4DBE545A872231AEB1291277D9CEA4B8CC1962673024E"},
		{"0000000000000007685E08A72EF279DF40CEC113E366223FA250BA06244D5916", "000000000000000000000014033AEE1C2D445050482F492DD478A5949A16DF58", "06A2021783605FFC37F507EDAEB29825A9E5BCA6C158FA5C8D2FCF42639E1EB4"},
		{"000000000000000C0F38EAAF4D2D56AE93D94342AC139E9219272E7D0914DB34", "00000000000000000000000000000005F3C6B26E5AA3BD93B19CAF6EA44DA897", "83F6AE8C060E49CA1456A5609A1CACD45E7E9BDD22F2CB33A9A191BA7B0D083D"},
		{"000000000000000E182CA78886424B3CE491F34679EFC83711CB88F3C7C795F4", "00000000000000000000000000000000B58B95C791BD80BFEFD968DCFF6789D3", "70741B6A584FCB85E251FD2FCE9DBE47C3F08A6ED3D3DB0E80404A18BC6403E3"},
		{"0000000000000076FCFEB7B651FDDAFF14687BD6258B8BB3D4EC1AC95116D980", "00000000000000000000000000000000051C80B4BC52F61ADCCA5E62E8A67EFC", "55C8BC953668A3FDC3886448DD525229B4C89525C8205039B95E23FE7600316B"},
		{"00000000000000E298C209355396B380273AC2B9282040A342424D6842921B6A", "00000000000000000796794D0260D2951B54665FDC78EEB6E29385055845CCB0", "DBBA952AEB093459E11D1E74C548102F7F660FE5E2957ACCC5BB637179470835"},
		{"000000000000014F1CB8BC5A1CA6495B048000F3C23D39121BF9590F6501F232", "00000006FA434F57AE00E5C6BEA17C85B724C170B9DD21BFE7F40480289A786E", "AD58E040C8F17294010E0296ABD6AF3AC9744F63FC300A8148FBDDF963ADF1BC"},
		{"000000000000040AF301CDD792EC55937F604D95ECBC524A92855653A72B1183", "00000000000005E68B3F2FD45F5564BC162CDEECA738B3B1F2B564DD4DF357B9", "E06FE69AEFB34DDA1CF3D387BD993089B3A74FE361531E7D7495DFD77B84AAE7"},
		{"0000000000000CA1989F1E4DD06F120B6692305996C634B7AC64A3D867FD84C2", "000000000BC0B1CB1D04D4FA6C23236336EF5F87A7CD96F19F693808F9CE81B9", "D2E15DFA99DFA87F3853C07E7F42814791C946FD3A912E372048028F3875CDB7"},
		{"0000000000000E1BB7B1034B9185A8641FAF264096AA708DA82F0889572363D0", "05BE2C6C5C454FE78F59330B3EBD77801F10F344F61385DEAE34FE6CDF6D2668", "C6B2A173A2B385A99D1002811DF16F3255A08FF30A3003AE145D016CEB1D1E22"},
		{"00000000000018EBA298C2368D5C1BC99E415C26286A53C18CC5997B7E44F145", "0000000000000000000000000001D753AD91C3B3CAA9C474FCFC2F629446F90F", "F188F243B057282E37D846B0D4A2FF4B3DD4252E04EA8FEE71579E370A875D04"},
		{"0000000000002BFF96A10391986D604780AEB02CF7DB8A0953E2E8812DCDFCBC", "000000000000000000000000000000F830EC7E56CBEA1A2922F4C4CD097E6BFD", "11F1E2AEBD3EFA5EE6E933BC916FEDBBBA89D0C1A639E8EEC32CA76ED71F2337"},
		{"0000000000003B65F10994B468166B43546A123F2EEF564C9B0005D8AD1C2578", "0982772FD855EB1F707C4054DEC2E6196D8B5418836CF0F1EB4B1041EBD69F77", "D1F300C61140409C932250BE3B6E4CDB3968CAADA297FF3FA21156D760D26920"},
		{"000000000000E259F70126128EDCDB034B73A2B6F6A0A8B92AEA672D1E711EE6", "0000000007E397F3DF07AF78F0731AB12707CD8907D6D6598840EF3CF341DF76", "4A680827FDD9B852D340D63C5535DBAC35098DC3B0393925AE876752CCDADEA3"},
		{"000000000000EAE9224712C1314F8B192DC903E07B032848AF9C2142156F7B64", "000000000000E6C158AF9DA9B5E760CEEE373647581F85B94F665393E37E0C03", "4B5C8DB1C19C4433E2BD481E0D5D1AF3B242BAAAC0D63465433E7976E2DA7959"},
		{"00000000001FEF813BB1E9DDF47F1C5A36EA7A44F3E10979D4AE7951451EB4C5", "000000000000000000000000CB63CA115C4568491CC818F55312F6FDC06DB22F", "64A0A4517C5E05847423426FE43A8E166C4570214BFE845A1DBDDDF748151647"},
		{"00000000002627CF0FFB6C33F1382E55C83914D7EA8968B7E3ED543740FA345B", "0000000000000000000000000000000002DD00447C7815C6FF25DD25EE3D4859", "93EE99F3D207EF41CA19841D6A1C129717D640F92FD4BD86D4AC704F4BE93275"},
		{"0000000000B6605E407376B8D010F939E4427890700F46D886AEDD94CACBC365", "00000000000000000000007191DBC44B22C59B6B366038BA939691BC8A197812", "4C6C09238DB5E593B7A7D0A711535613317915B81B650EEA49B0CF088D94BE10"},
		{"00000000018A0BBFBDBE8125C22B9460C4A8C88FBC489627554F948988D3531E", "00000000000000000000333F969564FC82A322583EB1C214A9FB434FB7BB6238", "FE87840F5A51463FB8EF553E6D1BB5393B64B79AA8AA021941A9939D7A64CB13"},
		{"0000000002188E491F2E4E2BEB176582D4956CEFF4F7604B8B905578DE122B9B", "00000000000000000000000000001F03A80805957B2E849F8D717C7E35951BED", "4CF2614C1673FB43CB17DF013C099B0DCF7AC88F502F0EDF42F5BF54E75CC71F"},
		{"000000000810643E4E70DD261901DD93ACDD47AF0D970253F5239948CF4695BC", "00000000000000000000005EE529D34413E6701EADF9BDDE206D5D7192B78EF2", "235075602822DC4B03B200068995EE38E4F02D86A55BFD9281DD5BBCB2DC3DC3"},
		{"0000000CE3DBA4F1A6DE33DF007B74F8348E880A5EBCC0C84ED0F15EF0F4D1B7", "1B8AE2A7A517E4FE5136A01EE05B8651EFE9EBC1D57A1CE926E8BDE8D33FF2BE", "86AE76074388E781FAFDFD8CFD442F6F4A2DD505602ACCCC8C021EC6ADC2ED57"},
		{"000000BD89585B09710168D979B7792E687DA0886998B67D1D65E274F1F47205", "03287540105E312A1D7A1F5C322499836C40AFC06301F6D5BE0150FFC0E71AB0", "E885128C0303BDF3307EB42C81D8AE69210A62000CF0BB1CEB8BB983B2BB34D7"},
		{"000002421B603AE6ABC44EECE49A53CA57FF0705EE34D1CB70AD27EC7AC2617B", "0000000000000000000000000000000000223D2E256CB108682E35878E428D3C", "84E5C478886BA089CE496F3CC3F61187F015EAAC94308761A815152F3BA1E159"},
		{"000003915BF1B8DE4DC96F356413EA543AB7B97F95E3EEF1B7F56D7EEC547661", "000000000000000000000000000000000000003936781CEDD0A7050AC2A19D58", "A8C76E53FD410CF50AF52B9742129306104C3E7464D4EDFDF549231410AAB130"},
		{"000013947F70CFEFEA13A8B540FB4F092194BCBE02C6DD07EB25BB3D503A14EE", "0007238AC8432226B11CA4A75B51E9DE27CFF370B355CBA11D4EA6EAF5AF78BF", "DE42D762C57F1F3FAFF22167E1A606CD9395D4C9B4E3D9EFDD14E65784564A64"},
		{"000077DAD0D4C70FE3DC3F3CB421C3B514CD16D0693BADDDB571BCC099BD9CC6", "00000000000000000000000000000000000000276D0E3BC8504F9BA260198AE2", "E9CA1E9EF86A13F7389507A20B2B2AFBA0DA764E6FE43EB91B06434345947F62"},
		{"0000E266CD2ACCABD888B3C9B358C3175A74623EB72F49CEDC6BFF479B853A28", "000000000000005036629926C63B1FB896C0F36575A86357FE273C832139CD7C", "1D335C71D41034AAE9B9D882A2737FDA38A3EC980B449F74D214C6DCD55EB3A2"},
		{"000198AA2C53620AE8E551D0FA9BEF2732DF3104457C73930C778707A120833D", "0000000000000001756CAD86E47398BD87BEF7B9280972A1E41BA2D1F83654A3", "5C50CEB5D7ED89E4F35B7C5CE72B33CCDD8A86A9BC311C5DFCA1F005AD47F6FB"},
		{"0002CC80CAA6B204B06CBE0B22DFA9C1134C679116E5644E22FC61D0CC55D2E3", "0000000000F9D190E26DCB41D9A04E80C18FC7BFA7012F3E5BB24B42A35629FD", "9BF42F22BB4ADDDC5AFA4B5A70DBC5C3D5690810F45A53A4CFE3AC5DA7E7F2E6"},
		{"00055D796CB7EB598CC231FA679C271D018FD853B2D1F0112DE4C6F0D37327CD", "000000000000000000000000000047822F1D9EE6CA35D282C39FCCC7A0FD1EE6", "E5DE2EC2730A9246C8EE07E7CB15D5261EEA8C28D3E9D55D864ED006013285E4"},
		{"0020921D3CB837D05B8FDC802070A2B495F7600E388BD34FC311FB50FE2ACCC5", "0000000000000000000000005E1D5C76C84A311BD65F3AF3E65055F0547A13C3", "6E04CD4D2B66B3F98AEBADB9EC53E66334775572559B552066E5AF7B9A11E759"},
		{"004C35BEBADA0CF615E6F936368D6249B29E70CC02A984BD544173D30858A346", "0000000002053B5E46899DC8CBD3D21792C65FED2D6A6FC8BF85361CA9DEC06B", "4C1207203EB5A2FF3DCF98D1933C94B3C4022202F2E5DEC9E1502C60A49DFCA9"},
		{"00AA1EB8B1DD9734BE83C3585682FB982A7091F33A513920649E04C4F54EC9AB", "00000000000000000000000000000000000F42267D57E7135872110E5BA35EEE", "1CEEFB362C42AE31DE7EBC3A76D92A102D2EBB02B2A66524D98C4E7F0D55A899"},
		{"00CA5F3DFCA3A4A3EB5E2FFCBB516C47D95BA1F7C87745085EB80DA3DE753BEA", "0000000000F1E31533849590CAD86B324082CB5A77B2A2B944F2DF5B88281D1E", "85C700C0820E21808935C1E07ADFB6120F71D2DFAA0B95DAAEC049F135A6EBD5"},
		{"0285577C5736AD97043B6D047B4E9C37E259BB10563515BCB6F44B49E9AE6407", "0BC492DC24DA6AC4678A82A123A946FA4E34B3184AAC4C1DA3FD95EC06231AD7", "871658A6845A2E5C30DA9F5A4FFB7DFBCBAB7E36C984E9F26E7EC3F9EAD24E6B"},
		{"07E846C9227A4CB6AB42C1DD2212271A020CA9A5360B4D2E86532096CC28B0F0", "6141D41F38B684C637757F481CE155FC74A479179891F8ADD96B39C358AD32B8", "EE7A199ABBDD95691ED1FA0544BB323C8CCD0AD88AD5108A2246F820DD4F5140"},
		{"0C7F3663E0C94609B4ED2D85702AB1D8C8522B72763495B29C0F96521C76F42F", "0000000000000000000000000000000000032CE080803B7A13DDA23FC7172D7B", "B1D7D0419E6524521747397340DF1A10612ECEBC7F33E9B609058B0BFF2B56EA"},
		{"185F1A31C76C1319B2ADC91D4713D0490BCD46E17F01B25F1814CD6AC5ACB07B", "820BD103157B9E46C7C7BF3869FF62107F38A769373917101B44EAA206169B14", "0D93320F92E7E37A5A477915438986837B0141D5960D5CE24911CD4FEE3B2FDF"},
		{"21FD10B57E729D5CF698457F1BFB33C05461C3286C157B3A0B29D15DAE44A72F", "9A1BE44E73C555ED8A3B95C829423D2B607B21B72EF62167B18F2A98EE5D57B3", "068EA6F1F44EABA41388D558B34F5CE4BF2E6B8BF8246478626CC8E6AA4BCA60"},
		{"23EFF8A188E850427398668993CCDA6AEA75E4460D14B0C2ECDEEF7F999B83D0", "000000000000000000000000000000007E11294A6888281486CCB4BCC86C026D", "D8F746AF623674E28CC9570ECB07A24175F6AB5C664B0BD441CFC7AE84EBDF8D"},
		{"3CA00B8BACFCEA0D84D56BFF140E76687F004B35BC4E083CE9C8F5F8AEEDCF47", "07AC194E89B5191298E4C250761D2D60AE2A5E6708DDC21EE02A5F4B038EFF15", "3F4D24E6287A0E478E36DBD69FFC979354CC7FFE3342697E884C00275A9E8378"},
		{"499C55147795257DF2CC8BFD407E24782B5025A7AB894B21742D3B2D9F98D160", "6685B0E744F44153C0F3786A270C3C62434F59B6B6B525F6E6524FA61EB986A5", "242D1B1EBAADF4BCECF2BE7165AB268CC6B6270FF8835807B14D28BBE6C2C72A"},
		{"5F1F4BFDEDD29F0689892A69507BF8C7D50D47ADCC7D9C2615298F30DE645137", "FB063F7500D7DD0219B9B9A19FD2196E58D1C9629232A75C9EEC38A8095E13D4", "942BAEBE9A49AEF24C13911FE4F213BC8A583C1B012D13060BCA1235FA4B3FE8"},
		{"B70CFEC366E46390B39BB572D0511B88AA2AE6C5FD68D21368624696947B3869", "48FC042F64BCFE653CA2DEFB5E03BF91B6CC42093F0BF0E69A49286792C42780", "561AEAC7A8F80C950C9A0F864CC2FC4C35DFE546D2DC26BB6E4AA823B7E50652"},
		{"DBD14AA6D37D93A19ED5F09178F1E02984B4C7FCB0235F55B7897CD3F143CAC9", "209AA16772271923D258A8EE1AC51E8E684FE89A841EBE9A5F72F07170B2F9AE", "8C149286067E400F21945AE21E0378268048BCADF6E7DDDE607F03D73C5659F7"},
		{"E3E7D5BBA9E6BA0ACF981607FAD8004BEB31D99121F5AED271C2B31A22753341", "F754C7681141D64E70FD8C2DE1723FAE23DD9CC64E359210F7CE6E1A68B2FC58", "9E1BC1F3577B9DBA7F24E20CE23E3022A4074E0CD50B54F3F2C00E908EA70CB5"},
		{"EE1AC7935818699AD1790FC415776484C6D3D8D90C4D8EBC3686C152B822D076", "9950DFB98E10659F3EA73A635A1B1547B9B54C1E9128A4B418E4BE938007F968", "B53E6A97998D2AF4B97AE947AEB4F308ECBE08B163C01BBB4CF33EDE2E6BF4D8"},
	};
	for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
		ThreeStrings &tc = cases[i];
		Uint256 a(tc.a);
		Uint256 b(tc.b);
		
		CurvePoint p(CurvePoint::G);
		p.multiply(a);
		p.multiply(b);
		p.normalize();
		
		CurvePoint q(CurvePoint::G);
		q.multiply(a);
		q.normalize();
		q.multiply(b);
		q.normalize();
		
		CurvePoint r(CurvePoint::G);
		r.multiply(Uint256(tc.c));
		r.normalize();
		
		assert(p == q && q == r);
		numTestCases++;
	}
}


static void testPrivateExponentToPublicPoint() {
	ThreeStrings cases[] = {
		{"0000000000000000000000000000000000000000000000000000000000000001", "79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798", "483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8"},
		{"0000000000000000000000000000000000000000000000000000000000000002", "C6047F9441ED7D6D3045406E95C07CD85C778E4B8CEF3CA7ABAC09B95C709EE5", "1AE168FEA63DC339A3C58419466CEAEEF7F632653266D0E1236431A950CFE52A"},
		{"000000000000000000000000000000000000000000000000000000000000000F", "D7924D4F7D43EA965A465AE3095FF41131E5946F3C85F79E44ADBCF8E27E080E", "581E2872A86C72A683842EC228CC6DEFEA40AF2BD896D3A5C504DC9FF6A26B58"},
		{"0000000000000000000000000000000000000000000000000000000000000010", "E60FCE93B59E9EC53011AABC21C23E97B2A31369B87A5AE9C44EE89E2A6DEC0A", "F7E3507399E595929DB99F34F57937101296891E44D23F0BE1F32CCE69616821"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364139", "2F01E5E15CCA351DAFF3843FB70F3C2F0A1BDD05E5AF888A67784EF3E10A2A01", "A3B25758BEAC66B6D6C2F7D5ECD2EC4B3D1DEC2945A489E84A25D3479342132B"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD036413A", "5CBDF0646E5DB4EAA398F365F2EA7A0E3D419B7E0330E39CE92BDDEDCAC4F9BC", "951435BF45DAA69F5CE8729279E5AB2457EC2F47EC02184A5AF7D9D6F78D9755"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD036413C", "2F8BDE4D1A07209355B4A7250A5C5128E88B84BDDC619AB7CBA8D569B240EFE4", "2753DDD9C91A1C292B24562259363BD90877D8E454F297BF235782C459539959"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD036413E", "F9308A019258C31049344F85F89D5229B531C845836F99B08601F113BCE036F9", "C77084F09CD217EBF01CC819D5C80CA99AFF5666CB3DDCE4934602897B4715BD"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD036413F", "C6047F9441ED7D6D3045406E95C07CD85C778E4B8CEF3CA7ABAC09B95C709EE5", "E51E970159C23CC65C3A7BE6B99315110809CD9ACD992F1EDC9BCE55AF301705"},
		{"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364140", "79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798", "B7C52588D95C3B9AA25B0403F1EEF75702E84BB7597AABE663B82F6F04EF2777"},
	};
	for (unsigned int i = 0; i < ARRAY_LENGTH(cases); i++) {
		ThreeStrings &tc = cases[i];
		CurvePoint p(CurvePoint::privateExponentToPublicPoint(Uint256(tc.a)));
		assert(p.x == FieldInt(tc.b) && p.y == FieldInt(tc.c) && p.z == FieldInt(Uint256::ONE));
		numTestCases++;
	}
}


int main(int argc, char **argv) {
	testReplace();
	testTwice();
	testAdd();
	testMultiply();
	testMultiplyModOrder();
	testPrivateExponentToPublicPoint();
	printf("All %d test cases passed\n", numTestCases);
	return 0;
}
